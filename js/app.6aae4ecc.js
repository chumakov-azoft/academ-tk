(function(t){function e(e){for(var i,a,n=e[0],l=e[1],c=e[2],u=0,h=[];u<n.length;u++)a=n[u],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&h.push(o[a][0]),o[a]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);d&&d(e);while(h.length)h.shift()();return r.push.apply(r,c||[]),s()}function s(){for(var t,e=0;e<r.length;e++){for(var s=r[e],i=!0,n=1;n<s.length;n++){var l=s[n];0!==o[l]&&(i=!1)}i&&(r.splice(e--,1),t=a(a.s=s[0]))}return t}var i={},o={app:0},r=[];function a(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=t,a.c=i,a.d=function(t,e,s){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(s,i,function(e){return t[e]}.bind(null,i));return s},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],l=n.push.bind(n);n.push=e,n=n.slice();for(var c=0;c<n.length;c++)e(n[c]);var d=l;r.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"0878":function(t,e,s){},"0b65":function(t,e,s){"use strict";var i=s("44c8"),o=s.n(i);o.a},"0ee0":function(t,e,s){},"0f9d":function(t,e,s){},1:function(t,e){},"19e7":function(t,e,s){"use strict";var i=s("32bd"),o=s.n(i);o.a},2:function(t,e){},"21bb":function(t,e,s){"use strict";var i=s("0f9d"),o=s.n(i);o.a},"281b":function(t,e,s){},"2fb4":function(t,e,s){},3:function(t,e){},"32bd":function(t,e,s){},3486:function(t,e,s){t.exports=s.p+"img/blue-yellow.8c6de712.png"},4:function(t,e){},"403f":function(t,e,s){"use strict";var i=s("0ee0"),o=s.n(i);o.a},"44c8":function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);var i=s("2b0e"),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-app",[s("transition",{attrs:{name:"fade",mode:"out-in"}},[s("router-view")],1)],1)},r=[],a={name:"App"},n=a,l=s("2877"),c=s("6544"),d=s.n(c),u=s("7496"),h=Object(l["a"])(n,o,r,!1,null,null,null),m=h.exports;d()(h,{VApp:u["a"]});var p=s("8c4f"),g=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-content",["admin"===t.$store.state.settings.role?s("v-speed-dial",{staticClass:"menu",staticStyle:{position:"absolute","z-index":"1"},attrs:{elevation:"10",top:"",right:"",direction:"left",transition:"slide-y-reverse-transition"},scopedSlots:t._u([{key:"activator",fn:function(){return[s("v-btn",{attrs:{fab:"",small:"",elevation:"5"}},[t.fab?s("v-icon",[t._v("mdi-close")]):s("v-icon",[t._v("mdi-menu")])],1)]},proxy:!0}],null,!1,1819352829),model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[s("v-btn",{attrs:{fab:"",small:"",elevation:"5"},on:{click:function(e){return e.stopPropagation(),t.onClick(e)}}},[s("v-icon",[t._v("mdi-pencil")])],1),s("v-btn",{attrs:{fab:"",small:"",elevation:"5"},on:{click:function(e){return e.stopPropagation(),t.onClick(e)}}},[s("v-icon",[t._v("mdi-plus")])],1),s("v-btn",{attrs:{fab:"",small:"",elevation:"5"},on:{click:function(e){return e.stopPropagation(),t.onClick(e)}}},[s("v-icon",[t._v("mdi-delete")])],1)],1):t._e(),s("silentbox-group",t._l(t.$store.state.medias,(function(e,i){return s("silentbox-item",{key:"thumb"+i,staticClass:"d-none",attrs:{id:"thumb--"+e[6],src:"/"===e[4][0]?t.$store.state.settings.base+e[4]:e[4],mid:e[6],description:e.length?e[5]:"",autoplay:!1,"hide-controls":!0}})})),1),s("Zoom",{on:{clickMedia:t.onClick}})],1)},f=[],y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("SvgPanZoom",{staticClass:"championsHighlight overHighlight zoom-fixed",staticStyle:{"user-select":"none"},style:1,attrs:{zoomEnabled:!0,dblClickZoomEnabled:!1,controlIconsEnabled:!1,fit:!1,center:!1,customEventsHandler:t.options},on:{svgpanzoom:t.registerSvgPanZoom}},[s("svg",{staticStyle:{width:"100%",height:"100%"}},[s("defs",[s("clipPath",{attrs:{id:"match"}},[s("rect",{attrs:{x:"0",y:"0",width:t.matchWidth,height:"60",rx:"5",ry:"5"}})]),s("clipPath",{attrs:{id:"half"}},[s("rect",{attrs:{x:"0",y:"0",width:t.matchWidth,height:"30",rx:"5",ry:"5"}})]),s("filter",{attrs:{id:"dropshadow",width:"135%",height:"140%"}},[s("feGaussianBlur",{attrs:{in:"SourceAlpha",stdDeviation:"3"}}),s("feOffset",{attrs:{dx:"2",dy:"2",result:"offsetblur"}}),s("feComponentTransfer",[s("feFuncA",{attrs:{type:"linear",slope:"0.5"}})],1),s("feMerge",[s("feMergeNode"),s("feMergeNode",{attrs:{in:"SourceGraphic"}})],1)],1)]),s("g",[s("g",{staticStyle:{fill:"none","stroke-width":"4","stroke-linecap":"butt"}},t._l(t.curves,(function(t,e){return s("path",{key:"curv"+e,attrs:{stroke:t.color,"stroke-dasharray":t.dash,d:t.d}})})),0),t._l(t.stages,(function(e,i){return s("g",{key:"stage-"+i,attrs:{id:"stage"+i}},[t._l(t.matches[i],(function(e,o){return s("g",{key:"game"+o},t._l((e||[]).filter(Boolean),(function(t,e){return s("match",{key:"match"+i+"."+o+"."+e,attrs:{seeds:t.seeds,order:t.order,names:t.names,logos:t.logos,position:t.position,ratings:t.ratings,scores:t.scores,status:t.status}})})),1)})),t._l((t.places[i]||[]).filter(Boolean),(function(e,o){return s("g",{key:"place"+i+"."+o},[e.seed?s("place",{attrs:{seed:e.seed,order:e.order,position:e.position,rating:e.rating,place:e.place,delta:e.delta}}):t._e()],1)})),s("groupRow",{attrs:{s:i,position:[0,0]}})],2)})),s("medias")],2)])])},v=[],b=s("c8b5"),x=s.n(b),w=s("2c0f"),S=s.n(w),_=(s("310e"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("g",{staticStyle:{filter:"url(#dropshadow)"},attrs:{status:t.status,id:"match-"+t.order[0]+"-"+t.order[1]}},[s("g",{class:t.single?"clipHalf":"clipMatch",attrs:{transform:"translate("+t.position[0]+" "+(t.position[1]+(t.single?15:0))+")"}},[s("half",{class:{winner:t.finished&&t.win1||t.single},attrs:{seed:t.seeds[0],id:"player"+t.seeds[0],order:t.order.concat(0),logo:t.logos[0],name:t.names[0],score:t.scores[0],rating:t.ratings[0],status:t.status1}}),t.single?t._e():s("half",{class:{winner:t.finished&&t.win2},attrs:{seed:t.seeds[1],id:"player"+t.seeds[1],order:t.order.concat(1),logo:t.logos[1],name:t.names[1],score:t.scores[1],rating:t.ratings[1],status:t.status2,transform:"translate(0 30.5)"}})],1)])}),$=[],P=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("g",{class:{empty:t.empty},on:{mouseout:function(e){!t.empty&&t.$store.commit("out",{order:t.order,$event:e})},mouseover:function(e){!t.empty&&t.$store.commit("over",{order:t.order,$event:e})},click:function(e){return t.$store.commit("click",{order:t.order,$event:e})}}},[s("rect",{staticClass:"player",attrs:{width:t.matchWidth,height:"30"}}),s("rect",{staticClass:"player--shade",attrs:{x:"35",width:t.matchWidth-(t.single?34:69),height:"30"}}),s("rect",{staticClass:"player--chevron",attrs:{width:"6",height:"30",fill:t.chevron}}),t.showLogo?s("image",{attrs:{href:t.logo,x:"42.5",y:"6.5",height:"18",width:"18"}}):t._e(),t.empty?t._e():s("text",{staticClass:"match--rating",attrs:{x:"19",y:"19",width:"45",height:"12","text-anchor":"middle"}},[t._v(t._s(t.rating))]),t.empty?t._e():s("text",{staticClass:"match--name",attrs:{x:t.showLogo?65:45,y:"21",width:t.matchWidth-90,height:"21"}},[t._v(t._s(t.name))]),t.started?s("text",{staticClass:"match--result",attrs:{x:t.matchWidth-18,y:"21",width:"45",height:"21","text-anchor":"middle"}},[t._v(t._s(t.score))]):t._e()])},T=[],k={name:"Half",components:{},props:{order:{type:Array,default:()=>[]},seed:{type:Number,default:0},logo:{type:String,default:""},name:{type:String,default:""},score:{type:[Number,String],default:3},rating:{type:[Number,String],default:300},status:{type:String,default:""}},data:()=>({}),computed:{empty:function(){return""===this.status},started:function(){return this.status&&-1===this.status.indexOf("ready")},finished:function(){return"win1"===this.status||"win2"===this.status},sign:function(){return this.delta>0?"+":"-"},single:function(){return"single"===this.status},matchWidth:function(){return this.$store.state.settings.matchWidth},showLogo:function(){return this.$store.state.settings.showLogo&&!this.empty&&this.logo},chevron:function(){return""===this.status?this.$store.state.settings.defaultChevronColor:this.$store.state.colors[this.seed]}}},C=k,O=(s("eafc"),Object(l["a"])(C,P,T,!1,null,null,null)),V=O.exports,j={name:"Match",components:{Half:V},props:{seeds:{type:Array,default:()=>[]},order:{type:Array,default:()=>[]},position:{type:Array,default:()=>[0,0]},logos:{type:Array,default:()=>["",""]},names:{type:Array,default:()=>["",""]},scores:{type:Array,default:()=>[0,0]},ratings:{type:Array,default:()=>["100","200"]},status:{type:String,default:""}},data:()=>({}),computed:{finished:function(){return"win1"===this.status||"win2"===this.status},status1:function(){return"ready2"===this.status?"":this.status},status2:function(){return"ready1"===this.status?"":this.status},sign:function(){return this.delta>0?"+":"-"},single:function(){return"single"===this.status},win1:function(){return"win1"===this.status},win2:function(){return"win2"===this.status},matchWidth:function(){return this.$store.state.settings.matchWidth},matchHeight:function(){return"single"===this.status?this.$store.state.settings.matchHeight/2:this.$store.state.settings.matchHeight}}},M=j,W=(s("c565"),Object(l["a"])(M,_,$,!1,null,null,null)),A=W.exports,E=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("g",{class:"place--"+t.place,staticStyle:{filter:"url(#dropshadow)"},attrs:{id:"player"+t.seed},on:{mouseout:function(e){return t.$store.commit("out",{order:t.order,$event:e})},mouseover:function(e){return t.$store.commit("over",{order:t.order,$event:e})}}},[s("g",{attrs:{transform:"translate("+t.position[0]+" "+t.position[1]+")"}},[s("polygon",{staticClass:"place",attrs:{points:"7,5 7,25 -5,15"}}),s("rect",{staticClass:"place",attrs:{x:"5",width:t.placeWidth,height:"30"}}),s("rect",{staticClass:"place--shade",attrs:{x:"35",width:t.placeWidth-64,height:"30"}}),t.delta>0?s("rect",{staticClass:"place--plus",attrs:{x:t.placeWidth-29,width:34.1,height:"30"}}):t._e(),t.delta<0?s("rect",{staticClass:"place--minus",attrs:{x:t.placeWidth-29,width:34.1,height:"30"}}):t._e(),s("text",{staticClass:"match--rating",attrs:{x:"19",y:"19",width:"45",height:"12","text-anchor":"middle"}},[t._v(t._s(t.rating))]),s("text",{staticClass:"place--name",attrs:{x:"71",y:"20.5",width:t.placeWidth-90,height:"21","text-anchor":"middle"}},[t._v(t._s(t.place+" место"))]),s("text",{staticClass:"place--delta",attrs:{x:t.placeWidth-13,y:"20",width:"45",height:"21","text-anchor":"middle"}},[t._v(t._s((t.delta>0?"+":"")+t.delta))])])])},N=[],I={name:"Place",props:{order:{type:Array,default:()=>[]},seed:{type:Number,default:0},position:{type:Array,default:()=>[0,0]},rating:{type:Number,default:0},delta:{type:Number,default:0},place:{type:Number,default:0}},data:()=>({}),computed:{placeWidth:function(){return 140}}},R=I,L=(s("b745"),Object(l["a"])(R,E,N,!1,null,null,null)),K=L.exports,D=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("g",{staticStyle:{filter:"url(#dropshadow)"}},t._l(t.$store.state.medias,(function(e,i){return s("image",{key:"icon"+i,staticClass:"medias",attrs:{id:"icon--"+e[6],href:"/"===e[0][0]?t.$store.state.settings.base+e[0]:e[0],x:e[1],y:e[2],width:e[3],title:e.length?e[5]:""},on:{click:function(s){s.shiftKey?t.onSelect(e):t.onClick(e[6])}}})})),0)},z=[],B={name:"Medias",props:{},data:()=>({}),watch:{medias:{immediate:!0,handler(t,e){console.log("before",e,this.$route.params.media),null!==this.$route.params.media&&setTimeout(()=>this.onClick(this.$route.params.media),500)}}},methods:{onOver(t,e){this.diagonal||this.$store.commit("overGroupCell",{order:this.order,$event:t})},onOut(t,e){this.diagonal||this.$store.commit("outGroupCell",{order:this.order,$event:t})},onClick(t){this.$store.state.zoom.$emit("clickMedia",t),this.$route.params.media!==t&&this.$router.replace({params:{...this.$route.params,media:t}})},onSelect(t){this.$store.state.edit.itemsToMove.push(t)}}},G=B,J=(s("e9ed"),Object(l["a"])(G,D,z,!1,null,null,null)),X=J.exports,q=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("g",{staticStyle:{filter:"url(#dropshadow)"},attrs:{transform:"translate("+t.position[0]+" "+t.position[1]+")",id:"group-row-0"}},t._l(t.groups[t.s]||[],(function(e,i){return s("group",{key:"group"+t.s+"."+i,attrs:{index:e.index,order:e.order,seeds:e.seeds,position:e.position,rowWidth:t.rowWidth},on:{changeRowWidth:t.onChangeWidth}})})),1)},F=[],H=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("g",{attrs:{transform:"translate("+t.position[0]+" "+t.position[1]+")",id:"group-"+t.order[0]+"-"+t.index}},[s("defs",[s("clipPath",{attrs:{id:"group"+t.order[0]+"-"+t.index}},[s("rect",{attrs:{x:"0",y:"0",width:t.rowWidth,height:t.groupHeight,rx:"5",ry:"5"}})])]),s("text",{staticClass:"group--title",attrs:{x:"5",y:"-12","text-anchor":"start"}},[t._v(t._s(t.groupTitle))]),s("g",{style:"clipPath:url(#group"+t.order[0]+"-"+t.index+")"},[s("rect",{staticClass:"group",attrs:{width:t.rowWidth,height:t.groupHeight}}),s("text",{staticClass:"match--rating",attrs:{x:"22",y:"22","text-anchor":"middle"}},[t._v("#")]),s("text",{staticClass:"match--rating",attrs:{x:"49",y:"22","text-anchor":"end"}},[t._v("R")]),s("text",{staticClass:"match--rating",attrs:{x:"90",y:"22","text-anchor":"end"}},[t._v("Пара")]),s("text",{staticClass:"match--rating",attrs:{x:30*t.seeds.length+t.nameWidth+117,y:"22","text-anchor":"end"}},[t._v("Очки")]),s("text",{staticClass:"match--rating",attrs:{x:30*t.seeds.length+t.nameWidth+120+this.deltasWidth/2,y:"22","text-anchor":"start"}},[t._v("Дельта")]),s("text",{staticClass:"match--rating",attrs:{x:t.rowWidth-20,y:"22","text-anchor":"end"}},[t._v("Место")]),t._l(t.seeds,(function(e,i){return s("text",{key:"groupKey"+i,staticClass:"match--rating",attrs:{x:t.nameWidth+97+30*i,y:"22","text-anchor":"end"}},[t._v(t._s(i+1))])})),t._l(t.seeds,(function(e,i){return s("group-line",{key:"groupLine"+i,attrs:{id:"player"+e,transform:"translate(10 "+(30*i+29)+")",index:i,seeds:t.seeds,order:t.order.concat([i]),backWidth:t.rowWidth-20,backVisible:!(i%2)},on:{changeDeltasWidth:t.onChangeDeltasWidth}})}))],2)])},Z=[],U=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("g",{class:t.placeClass},[t.backVisible?s("rect",{staticClass:"group-player-shade",attrs:{width:t.backWidth,height:"30"}}):t._e(),t.seed>=0?s("rect",{staticClass:"group-player",attrs:{width:t.nameWidth+70,height:"30"}}):t._e(),t.seed>=0?s("rect",{staticClass:"group-player-end",attrs:{x:t.tableAndNameWidth,width:Math.max(1,t.backWidth-t.tableAndNameWidth),height:"30"}}):t._e(),t.seed>=0&&t.showLogo?s("image",{attrs:{href:t.logo,x:"42.5",y:"6.5",height:"18",width:"18"}}):t._e(),s("text",{staticClass:"group-player-order",attrs:{x:"12",y:"19","text-anchor":"middle"}},[t._v(t._s(t.order[2]+1))]),t.seed>=0?s("text",{staticClass:"group-player-rating",attrs:{x:"36",y:"19","text-anchor":"middle"}},[t._v(t._s(t.rating))]):t._e(),t.seed>=0?s("text",{staticClass:"group-player-name",attrs:{x:t.showLogo?75:55,y:"21",textLength:t.stretchNames?t.nameWidth:0}},[t._v(t._s(t.name))]):t._e(),s("g",{attrs:{transform:"translate("+(t.nameWidth+70)+" 0)"}},t._l(t.seeds,(function(e,i){return s("group-cell",{key:"groupCell"+i,staticClass:"group-cell",attrs:{id:"group-"+t.order[0]+"-"+t.order[1]+"-"+t.order[2]+"-"+i,transform:"translate("+30*i+" 0)",order:t.order.concat([i])}})})),1),t.seed>=0?s("text",{staticClass:"group-player-score",attrs:{x:t.tableAndNameWidth+35,y:"21",width:"45",height:"21","text-anchor":"middle"}},[t._v(t._s(t.total))]):t._e(),t.seed>=0?s("g",{attrs:{transform:"translate("+(t.tableAndNameWidth+50)+" 0)"}},t._l(t.deltas,(function(e,i){return s("group-delta",{key:"groupDelta"+i,staticClass:"group-delta",attrs:{id:"group-"+t.order[0]+"-"+t.order[1]+"-"+t.order[2]+"-"+i,transform:"translate("+(e.x+8)+" 0)",order:t.order.concat([i]),delta:e}})})),1):t._e(),1===t.place.length?s("text",{staticClass:"group-player-place",attrs:{x:t.backWidth-25,y:"21","text-anchor":"middle"}},[t._v(t._s(t.place[0]))]):t._e(),2===t.place.length?s("text",{staticClass:"group-player-range",attrs:{x:t.backWidth-25,y:"21","text-anchor":"middle"}},[t._v(t._s(t.place[0]+".."+t.place[1]))]):t._e()])},Y=[],Q=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("g",{on:{mouseover:function(e){return t.onOver(e)},mouseout:function(e){return t.onOut(e)}}},[t.diagonal?s("rect",{staticClass:"group-cell-shade",attrs:{width:"30",height:"30"}}):t.empty?s("rect",{staticClass:"group-cell-empty",attrs:{width:"30",height:"30"}}):t._e(),t.plus?s("rect",{staticClass:"group-cell-plus",attrs:{width:"30",height:"30"}}):t._e(),t.minus?s("rect",{staticClass:"group-cell-minus",attrs:{width:"30",height:"30"}}):t._e(),t.progress?s("rect",{staticClass:"group-cell-progress",attrs:{width:"30",height:"30"}}):t._e(),t.started?s("text",{staticClass:"group-cell-text",attrs:{x:"15",y:"21",width:"30",height:"30","text-anchor":"middle"}},[t._v(t._s(t.resultText))]):t._e()])},tt=[],et={name:"GroupCell",props:{order:{type:Array,default:()=>[]}},data:()=>({}),computed:{version:function(){return this.$store.state.version},result:function(){return this.$store.state.scores[this.order[0]][this.order[1]][this.order[2]][this.order[3]]},resultText:function(){return"Tex"===this.result[0]||"Tex"===this.result[1]?"Tex":this.result[0]+":"+this.result[1]},diagonal:function(){return this.order[2]===this.order[3]},empty:function(){return""===this.status},started:function(){return this.status&&-1===this.status.indexOf("ready")},progress:function(){return"progress"===this.status},finished:function(){return"win1"===this.status||"win2"===this.status},plus:function(){return"win1"===this.status},minus:function(){return"win2"===this.status},status:function(){return this.diagonal?"":this.result?this.result[2]:""}},methods:{onOver(t){this.diagonal||this.$store.commit("overGroupCell",{order:this.order,$event:t})},onOut(t){this.diagonal||this.$store.commit("outGroupCell",{order:this.order,$event:t})}}},st=et,it=(s("7b09"),Object(l["a"])(st,Q,tt,!1,null,null,null)),ot=it.exports,rt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("g",{on:{mouseover:function(e){return t.onOver(e)},mouseout:function(e){return t.onOut(e)}}},[t.delta.value>=0?s("rect",{staticClass:"group-delta-plus",attrs:{x:"0",y:"5",width:t.delta.width,height:"20"}}):s("rect",{staticClass:"group-delta-minus",attrs:{x:"0",y:"5",width:t.delta.width,height:"20"}}),s("text",{staticClass:"group-delta-text",attrs:{x:t.delta.width/2,y:"19","text-anchor":"middle"}},[t._v(t._s(t.delta.text))])])},at=[],nt={name:"GroupDelta",props:{order:{type:Array,default:()=>[]},delta:{type:Object,default:()=>{}}},data:()=>({}),computed:{},methods:{onOver(t){this.diagonal||this.$store.commit("overGroupCell",{order:this.order,$event:t})},onOut(t){this.diagonal||this.$store.commit("outGroupCell",{order:this.order,$event:t})}}},lt=nt,ct=(s("0b65"),Object(l["a"])(lt,rt,at,!1,null,null,null)),dt=ct.exports,ut={name:"GroupLine",components:{GroupCell:ot,GroupDelta:dt},props:{index:{type:Number,default:0},order:{type:Array,default:()=>[]},seeds:{type:Array,default:()=>[]},backVisible:{type:Boolean,default:!0},backWidth:{type:Number,default:300}},data:()=>({}),computed:{version:function(){return this.$store.state.version},result:function(){return this.$store.state.scores[this.order[0]][this.order[1]][this.order[2]]},seed:function(){return this.seeds[this.order[2]]},rating:function(){return this.$store.state.players[this.seed].rating},logo:function(){return this.$store.state.players[this.seed].logo},name:function(){return this.$store.state.players[this.seed].short},nameWidth:function(){return this.$store.state.settings.nameWidth},tableWidth:function(){return 30*this.seeds.length},tableAndNameWidth:function(){return this.tableWidth+this.nameWidth+60},total:function(){return this.result.reduce((t,e)=>e?"win1"===e[2]?t+2:"win2"===e[2]&&"Tex"!==e[0]?t+1:t:t,0)},deltas(){let t=0;const e=this.result.map((t,e)=>{if(t&&("win1"===t[2]||"win2"===t[2])){const s=this.seeds[e],i=this.getRatingDelta(this.$store.state.players[this.seed].rating,this.$store.state.players[s].rating,[t[0],t[1]]),o=Math.round("win1"===t[2]?i[0]:i[1]),r=o>0?"+"+o:String(o);return{value:o,text:r,width:5*r.length+8,time:t[4],seed2:s}}return null}).filter(Boolean).sort((t,e)=>{return t.time-e.time}).map(e=>{return e.x=t,t+=e.width+4,e});return this.$emit("changeDeltasWidth",t),e},showLogo(){return this.$store.state.settings.showLogo&&this.logo},stretchNames(){return this.$store.state.settings.stretchNames},place(){return this.$store.state.places[this.order[0]][this.order[1]][this.order[2]]||[]},placeClass(){if(1===this.place.length){const t=this.place[0].toString(),e=t.split("..");if("1"===e[0])return"place--1";if("2"===e[0])return"place--2";if("3"===e[0])return"place--3"}return null},chevron(){return""===this.status?this.$store.state.settings.defaultChevronColor:this.$store.state.colors[this.seed]}},methods:{getRatingDelta(t,e,[s,i]){if(s===i)return[0,0];const o=Math.abs(s-i),r=1===o?.5:2===o?.7:1,a=s>i?t:e,n=s<i?t:e,l=a-n;if(l<100){const t=(10-(a-n)/10)*r;return[t,-t/2]}return 2===o?[-l/100/2,l/100]:1===o?[-l/20/2,l/20]:[0,0]},onOver(t){this.diagonal||this.$store.commit("overGroupCell",{order:this.order,$event:t})},onOut(t){this.diagonal||this.$store.commit("outGroupCell",{order:this.order,$event:t})}}},ht=ut,mt=(s("7875"),Object(l["a"])(ht,U,Y,!1,null,null,null)),pt=mt.exports,gt={name:"Group",components:{GroupLine:pt},props:{index:{type:Number,default:0},order:{type:Array,default:()=>[]},seeds:{type:Array,default:()=>[]},position:{type:Array,default:()=>[0,0]},rowWidth:{type:Number,default:200}},data:()=>({deltasWidth:80}),computed:{groupTitle:function(){return this.$store.state.mesh[this.order[0]][this.order[1]][4]},groupHeight:function(){return 30*this.seeds.length+37},nameWidth:function(){return this.$store.state.settings.nameWidth}},methods:{onChangeDeltasWidth(t){this.deltasWidth=Math.max(this.deltasWidth,t),this.$emit("changeRowWidth",this.$store.state.settings.nameWidth+100+30*this.seeds.length+90+this.deltasWidth)}},mounted(){this.$store.state.groups[this.order[0]].length>this.order[1]+1&&(this.$store.state.groups[this.order[0]][this.order[1]+1].position[1]=Math.max(this.$store.state.groups[this.order[0]][this.order[1]+1].position[1],this.position[1]+this.groupHeight+15))}},ft=gt,yt=(s("403f"),Object(l["a"])(ft,H,Z,!1,null,null,null)),vt=yt.exports,bt={name:"GroupRow",components:{Group:vt},props:{s:{type:Number,default:0},position:{type:Array,default:()=>[0,0]}},data:()=>({deltasWidth:40,rowWidth:750}),computed:{nameWidth:function(){return this.$store.state.settings.nameWidth},groups(){return this.$store.state.groups}},methods:{onChangeWidth(t){this.rowWidth=Math.max(this.rowWidth,t)}}},xt=bt,wt=(s("a48f"),Object(l["a"])(xt,q,F,!1,null,null,null)),St=wt.exports,_t={components:{SvgPanZoom:S.a,GroupRow:St,Match:A,Place:K,Medias:X},data:()=>({visible:!1,hammer:null,options:{haltEventListeners:["touchstart","touchend","touchmove","touchleave","touchcancel"],init:function(t){const e=t.instance;let s=1,i=0,o=0;this.hammer=x()(t.svgElement),this.hammer.on("panleft panright tap press",(function(t){})),this.hammer.get("pinch").set({enable:!0}),this.hammer.on("doubletap",(function(t){e.$store.dispatch("centerMatch")})),this.hammer.on("panstart panmove",(function(t){"panstart"===t.type&&(i=0,o=0),e.panBy({x:t.deltaX-i,y:t.deltaY-o}),i=t.deltaX,o=t.deltaY;const s=e.getPan();localStorage["zoom"]=JSON.stringify({x:s.x,y:s.y,scale:e.getZoom(),section:e.$route.params["section"]})})),this.hammer.on("pinchstart pinchmove",(function(t){if("pinchstart"===t.type&&(s=e.getZoom(),e.zoomAtPoint(s*t.scale,{x:t.center.x,y:t.center.y})),t.deltaX){const t=e.getPan();localStorage["zoom"]=JSON.stringify({x:t.x,y:t.y,scale:e.getZoom(),section:e.$route.params["section"]})}e.zoomAtPoint(s*t.scale,{x:t.center.x,y:t.center.y})})),t.svgElement.addEventListener("touchmove",t=>t.preventDefault())},destroy:function(){}}}),computed:{matchWidth(){return this.$store.state.settings.matchWidth},stages(){return this.$store.state.stages},matches(){return this.$store.state.matches},places(){return this.$store.state.places},curves(){return this.$store.state.curves}},methods:{registerSvgPanZoom(t){this.$store.state.zoom=this,this.$store.state.zoomer=t,t.$store=this.$store,t.$route=this.$route,setTimeout(()=>this.visible=!0)}},mounted(){!0===navigator.standalone||setTimeout(()=>window.scrollTo(0,1))},beforeDestroy(){this.$store&&(this.$store.state.zoomer&&(this.$store.state.zoomer.$store=null,this.$store.state.zoomer.$route=null,this.$store.state.zoomer=null),this.$store.state.zoom=null)}},$t=_t,Pt=(s("19e7"),Object(l["a"])($t,y,v,!1,null,null,null)),Tt=Pt.exports,kt={name:"home",components:{Zoom:Tt},props:{section:{type:String,default:""}},data:()=>({fab:!1}),methods:{onClick(t){const e=document.querySelector("#thumb--"+t);e&&e.click()}},mounted(){this.$store.commit("initialize",this.section),document.onkeydown=t=>{t=t||window.event,console.log(t.code),0===t.code.indexOf("Digit")&&t.key<10&&t.key>=0?"group"===this.$store.state.edit.type?this.$store.dispatch("setGroupResult",+t.key):this.$store.dispatch("setMatchResult",+t.key):"KeyT"===t.code?"group"===this.$store.state.edit.type?this.$store.dispatch("setGroupResult","Tex"):this.$store.dispatch("setMatchResult","Tex"):"Space"===t.code?"group"===this.$store.state.edit.type?this.$store.dispatch("setGroupProgress"):this.$store.dispatch("setMatchProgress"):"Backspace"===t.code?"group"===this.$store.state.edit.type?this.$store.dispatch("deleteGroupResult"):this.$store.dispatch("deleteMatchResult"):"ArrowLeft"===t.code?this.$store.dispatch("moveObjects",{dx:t.shiftKey?-10:-1,dy:0}):"ArrowRight"===t.code?this.$store.dispatch("moveObjects",{dx:t.shiftKey?10:1,dy:0}):"ArrowUp"===t.code?this.$store.dispatch("moveObjects",{dy:t.shiftKey?-10:-1,dx:0}):"ArrowDown"===t.code?this.$store.dispatch("moveObjects",{dy:t.shiftKey?10:1,dx:0}):"Escape"===t.code?this.$store.state.edit.itemsToMove=[]:"KeyC"===t.code&&t.altKey?this.$store.dispatch("clearStorage"):"KeyA"===t.code&&t.altKey?this.$store.dispatch("restoreFromStorage"):"KeyS"===t.code&&t.altKey&&t.ctrlKey?this.$store.dispatch("saveAllResults"):"KeyS"===t.code&&t.altKey?this.$store.dispatch("saveResults"):"KeyF"===t.code&&t.altKey?this.$store.dispatch("saveFiles"):"KeyL"===t.code&&t.altKey&&(console.log(this.$route.name),"home"===this.$route.name&&(localStorage.githubToken="",this.$router.push("l")))}}},Ct=kt,Ot=(s("21bb"),s("8336")),Vt=s("a75b"),jt=s("132d"),Mt=s("c73b"),Wt=Object(l["a"])(Ct,g,f,!1,null,null,null),At=Wt.exports;d()(Wt,{VBtn:Ot["a"],VContent:Vt["a"],VIcon:jt["a"],VSpeedDial:Mt["a"]});var Et=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"about"},[i("section",[i("v-layout",{staticStyle:{"margin-top":"2.5em"},attrs:{"align-center":"","text-center":"",column:"","justify-center":""}},[i("img",{staticStyle:{width:"60%","max-width":"400px"},attrs:{src:s("3486")}}),i("h3",{staticClass:"display-3 ma-2"},[t._v("Azoft Tournaments")]),i("h4",{staticClass:"subheading"},[t._v("(открытые турниры Azoft по настольному теннису)")]),i("h5",{staticClass:"heading mt-6"},[t._v("Турнир пар 1.0 запущен!")])]),i("v-layout",{attrs:{"align-center":"",column:"","justify-center":""}},[i("v-btn",{staticClass:"mt-6",attrs:{to:"/events/pairs-1",dark:"",large:"",color:"#f2c008"}},[t._v("Смотреть таблицу")]),i("v-btn",{staticClass:"my-6",attrs:{dark:"",large:"",color:"#2483c5"},on:{click:t.goTg}},[t._v("Подключиться к чату")]),i("v-dialog",{attrs:{"max-width":"390"},model:{value:t.telegram,callback:function(e){t.telegram=e},expression:"telegram"}},[i("v-card",[i("v-card-title",{staticClass:"headline"},[t._v("Телегам чат")]),i("v-card-text",[t._v("\n            Установите приложение "),i("a",{attrs:{href:"https://tlgrm.ru/"}},[t._v("Телеграм")]),t._v(" и найдите в нём канал "),i("strong",[t._v("azoft tournaments")]),t._v(". Напишите в него ваше ФИО, сайт вашей компании (прикрутим логотип к вашей фамилии) и TTW рейтинг (если есть). Следите за обновлениями!\n          ")]),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(e){t.telegram=!1}}},[t._v("Я понял")]),i("v-btn",{attrs:{color:"red darken-1",text:""},on:{click:function(e){t.telegram=!1}}},[t._v("У меня Линукс")])],1)],1)],1),i("v-flex",{staticClass:"mb-5",attrs:{row:"",wrap:"","text-xs-center":""}},[t._v("\n        В январе будет личный турнир 2.0. Тренируйтесь! ;)\n      ")])],1)],1)])},Nt=[],It={name:"about",data:()=>({telegram:!1,blurred:!1}),methods:{goTg(){this.blurred=!1,window.onblur=function(){this.blurred=!0},document.location.href="tg://t.me/joinchat/FMaTykiB1RIoc7PMD5RTkQ",setTimeout(this.openTgPopup,3500)},openTgPopup(){this.blurred||(this.telegram=!0)}}},Rt=It,Lt=s("b0af"),Kt=s("99d9"),Dt=s("169a"),zt=s("0e8f"),Bt=s("a722"),Gt=s("2fa4"),Jt=Object(l["a"])(Rt,Et,Nt,!1,null,null,null);Jt.exports;d()(Jt,{VBtn:Ot["a"],VCard:Lt["a"],VCardActions:Kt["a"],VCardText:Kt["b"],VCardTitle:Kt["c"],VDialog:Dt["a"],VFlex:zt["a"],VLayout:Bt["a"],VSpacer:Gt["a"]});var Xt=s("bc3a"),qt=s.n(Xt),Ft=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"about",staticStyle:{"background-color":"#160d47",color:"white",height:"100%"}},[s("section",[s("v-layout",{staticStyle:{"margin-top":"2.5em"},attrs:{"align-center":"","text-center":"",column:"","justify-center":""}},[s("img",{staticStyle:{width:"60%","max-width":"600px"},attrs:{src:"/img/tt22.png"}}),s("h4",{staticClass:"subheading mt-n9"},[t._v("турнир по"),s("br"),t._v("настольному теннису в НГУ")]),s("h3",{staticClass:"heading mt-6"},[t._v("Рождественский турнир пар пройдёт 8 января!")])]),s("v-layout",{attrs:{"align-center":"",column:"","justify-center":""}},[s("v-btn",{staticClass:"mt-6",attrs:{to:"/events/08.01.2020",dark:"",large:"",color:"#e9141c"}},[t._v("Смотреть таблицу")]),s("v-btn",{staticClass:"my-6",attrs:{href:"https://vk.com/academ_tour",target:"_blank",dark:"",large:"",color:"#2483c5"}},[t._v("Подключиться к группе VK")]),s("v-flex",{staticClass:"mb-5",attrs:{row:"",wrap:"","text-xs-center":""}},[t._v("\n        Академтур 546 - 10 января, тренируйтесь! ;)\n      ")])],1)],1)])},Ht=[],Zt={name:"about",data:()=>({telegram:!1,blurred:!1}),methods:{goTg(){this.blurred=!1,window.onblur=function(){this.blurred=!0},document.location.href="tg://t.me/joinchat/FMaTykiB1RIoc7PMD5RTkQ",setTimeout(this.openTgPopup,3500)},openTgPopup(){this.blurred||(this.telegram=!0)}}},Ut=Zt,Yt=Object(l["a"])(Ut,Ft,Ht,!1,null,null,null),Qt=Yt.exports;d()(Yt,{VBtn:Ot["a"],VFlex:zt["a"],VLayout:Bt["a"]}),i["a"].use(p["a"]);const te=new p["a"]({routes:[{path:"/l",beforeEnter(){-1===location.href.indexOf("localhost")?location.href="https://github.com/login/oauth/authorize?scope=repo&client_id=bf870e3b39e7567fedf6&redirect_uri=http://academtour.github.io/#/settings":location.href="https://github.com/login/oauth/authorize?scope=repo&client_id=574751fedca734e7f208&redirect_uri=http://localhost:8080/#/settings"}},{path:"/",name:"about",component:Qt},{path:"/now",redirect:"/events/08.01.2020"},{path:"/events/:section/:media?/:score?",name:"home",component:At,props:!0,meta:{title:""}},{path:"/settings",name:"settings",meta:{},beforeEnter(t,e,s){if(-1!==location.href.indexOf("?code=")){const t=location.href.indexOf("?code="),e=location.href.indexOf("/",t),s=location.href.substring(t+6,e-1),i=-1!==location.href.indexOf("localhost")?"574751fedca734e7f208":"bf870e3b39e7567fedf6",o=-1!==location.href.indexOf("localhost")?"7b87fc1f1b8b5db41cdf9f9d2849184944bdaae6":"cc1ab401631b982dc63088f131f688e7365b2067";window.history.replaceState({},document.title,"/#/settings"),qt.a.post("https://cors-anywhere.herokuapp.com/https://github.com/login/oauth/access_token?client_id="+i+"&client_secret="+o+"&code="+s,null,{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(t=>{localStorage.githubToken=t.data.access_token}).catch(t=>{console.error(t)})}s()},component:null}]});te.beforeEach((t,e,s)=>{t.meta.title&&(document.title=t.meta.title),"/admin"===t.path?(localStorage["role"]="admin",s({path:"/"})):e.params["section"]&&t.params["section"]!==e.params["section"]?(s(),location.reload()):0===t.path.indexOf("/events")?s():"/"===t.path?s():s("/")});var ee=te,se=s("2f62");const ie={},oe=s("ca09"),re=s("2cb7");function ae(){s("bbc1")(ie,"chumakov-azoft/academ-tk",localStorage["githubToken"]),s("738d")(ie,re),s("fb3b")(ie),s("d4c1")(ie),s("95d0")(ie)}re.init((function(t){if(t)throw t})),ie.saveState=function(t,e,s){ie.readRef||ae(),ie.readRef("refs/heads/master",(i,o)=>{i&&console.warn(i),ie.loadAs("commit",o,(i,r)=>{i&&console.warn(i),ie.loadAs("tree",r.tree,(i,a)=>{i&&console.warn(i);const n=e.map((i,o)=>{return{path:t+e[o],mode:oe.file,content:s[o]}});n.base=r.tree,console.log(n),ie.createTree(n,(t,e)=>{t&&console.warn(t),ie.saveAs("commit",{tree:e,author:{name:"chumakov-azoft",email:"chumakov@azoft.com"},parent:o,message:"update"},(t,e)=>{t&&console.warn(t),ie.updateRef("refs/heads/master",e,(t,e)=>{t&&console.warn(t),console.log("done!",e)},!0)})})})})})},ie.saveFile=function(t,e){var s=document.createElement("a"),i=new Blob([e],{type:"text/plain"});s.href=URL.createObjectURL(i),s.download=t,s.click()};var ne=ie;i["a"].use(se["a"]);var le=new se["a"].Store({state:{version:1,zoom:null,zoomer:null,settings:{base:"",type:null,role:localStorage["role"]||"",defaultCurveColor:"#cccccc",defaultChevronColor:"#dddddd",defaultZoomX:20,defaultZoomY:20,defaultZoomScale:.9,showLogo:!0,nameWidth:210,shortType:"",pairWidth:300,matchWidth:220,matchHeight:60,maxScore:3},video:{audioTime:[],audio:[],chevrons:[],ratings:[],logos:[],names:[],scores:[],subtitle:"",scoreTime:[0],score:["0 0 0 0 0"]},edit:{itemToSwitch:null,itemsToMove:[],current:[0],type:"",over:[],next:!1,centeredMatch:0,readyMatches:[]},colors:["#ff0500","#0074d9","#01ff70","#fff100","#c200ff","#00f9ff","#ff8c00","#ff00bc","#003f83","#B50002","#019e47","#a7a400","#7b009d","#00969b","#773b00","#990063","#0074d9","#01ff70","#001f3f","#39cccc","#3d9970","#2ecc40","#ff4136","#85144b","#ff851b","#b10dc9","#ffdc00","#f012be","#aaaaaa","#dddddd","#7fdbff","#0074d9","#01ff70","#001f3f","#39cccc","#3d9970","#2ecc40","#ff4136","#85144b","#ff851b","#b10dc9","#ffdc00","#f012be","#aaaaaa","#dddddd","#7fdbff","#0074d9","#01ff70","#001f3f","#39cccc","#3d9970","#2ecc40","#ff4136","#85144b","#ff851b","#b10dc9","#ffdc00","#f012be","#aaaaaa","#dddddd"],info:{},stages:[],players:[],matches:null,groups:null,places:[],scores:[],curves:[],seeds:[],medias:[],mesh:[]},mutations:{initialize(t,e){if(e){const s=-1===window.location.hostname.indexOf("localhost")?"https://akadem.tk/":"";console.log(s),t.settings.base="events/"+e+"/";const i=Math.random();Promise.all([qt.a.get(s+t.settings.base+"info.json?v="+i),qt.a.get(s+t.settings.base+"players.json?v="+i),qt.a.get(s+t.settings.base+"mesh.json?v="+i),qt.a.get(s+t.settings.base+"seeds.json?v="+i),qt.a.get(s+t.settings.base+"scores.json?v="+i),qt.a.get(s+t.settings.base+"medias.json?v="+i)]).then(e=>{t.info=e[0].data,document.title=t.info.name,Ke(t,t.info.zoom),t.settings.type=t.info.type,t.settings.rtype=t.info.rtype,t.settings.shortType=t.info.shortType,t.info.nameWidth&&(t.settings.nameWidth=t.info.nameWidth),t.info.matchWidth&&(t.settings.matchWidth=t.info.matchWidth),t.settings.stretchNames=t.info.stretchNames,t.settings.showLogo=t.info.showLogo,t.stages=t.info.stages,t.players=e[1].data.players,t.mesh=e[2].data.mesh,t.seeds=e[3].data.seeds,t.scores=e[4].data.scores,t.medias=e[5].data.medias;try{de(t),"pairs"===t.settings.type&&ce(t,e[1].data.pairs),ue(t)}catch(s){console.log(s)}}).catch(t=>{console.error(t),ee.push({path:"/now"})})}},over(t,{order:e,$event:s}){fe(t,{order:e,$event:s})},out(t,{order:e,$event:s}){ye(t,{order:e,$event:s})},overGroupCell(t,{order:e,$event:s}){xe(t,{order:e,$event:s})},outGroupCell(t,{order:e,$event:s}){we(t,{order:e,$event:s})},click(t,{order:e,$event:s}){const i=e[0],o=e[1],r=e[2],a=e[3];s.ctrlKey||s.altKey?t.edit.itemToSwitch?(ye(t,{}),Ve(t,t.edit.itemToSwitch,e,!s.altKey),t.edit.itemToSwitch=null,fe(t,{order:e})):t.edit.itemToSwitch=[...e]:s.shiftKey?t.edit.itemsToMove.push(t.matches[i][o][r]):(0===o&&-1!==t.matches[i][o][r].names[a].indexOf("Записывайтесь")&&(document.location.href="tg://t.me/joinchat/FMaTykiB1RIoc7PMD5RTkQ"),t.edit.itemsToMove=[t.matches[i][o][r]])}},actions:{addVideoPoint({state:t,commit:e},{k:s,position:i}){console.log("add point",s,i);const o=t.video.score[t.video.score.length-1].split(" "),r=t.video.scoreTime[t.video.scoreTime.length-1];o[s]++,s<2&&(o[2]=0,o[3]=0),i=Math.floor(10*i)/10,r>=i?(t.video.score[t.video.score.length-1]=o.join(" "),t.video.scoreTime[t.video.scoreTime.length-1]=i):(t.video.score[t.video.score.length]=o.join(" "),t.video.scoreTime[t.video.scoreTime.length]=i),console.log('  "scoreTime": ['+t.video.scoreTime.join(",")+'],\n  "score": ["'+t.video.score.join('","')+'"]\n')},shrinkVideoPoint({state:t,commit:e},{position:s}){console.log("shrink to",s);let i=t.video.scoreTime[t.video.scoreTime.length-1];while(i>=s&&t.video.scoreTime.length>1)t.video.scoreTime.pop(),t.video.score.pop(),i=t.video.scoreTime[t.video.scoreTime.length-1],console.log(t.video.scoreTime.length,i,s);console.log('  "scoreTime": ['+t.video.scoreTime.join(",")+'],\n  "score": ["'+t.video.score.join('","')+'"]\n')},showVideoPoint({state:t,commit:e},{position:s}){console.log("scoreTime: ",t.video.scoreTime),console.log("score: ",t.video.score)},loadVideoBoard({state:t,commit:e},s){const i=-1===window.location.hostname.indexOf("localhost")?"https://azoft.tk/":"";return qt.a.get(i+t.settings.base+"/board/"+s+".json").then(({data:e})=>{t.video.audioTime=e.audioTime?e.audioTime.map(t=>"number"===typeof t?t:t.split(":").reduce((t,e)=>60*t+ +e)):[0],t.video.audio=Array.isArray(e.audio)?e.audio:[e.audio],t.video.chevrons=[e.chevron1,e.chevron2],t.video.ratings=[e.rating1,e.rating2],t.video.logos=[e.logo1?t.settings.base+e.logo1:"",e.logo2?t.settings.base+e.logo2:""],t.video.names=[e.name1,e.name2],t.video.subtitle=e.subtitle,t.video.scoreTime=e.scoreTime,t.video.score=e.score})},setGroupProgress({state:t,commit:e}){Se(t,t.edit.current)},deleteGroupResult({state:t,commit:e}){$e(t,t.edit.current)},setGroupResult({state:t,commit:e},s){t.edit.next?(_e(t,t.edit.current,s,!0),t.edit.next=!1,s>=t.settings.maxScore&&Pe(t,t.edit.current)):(_e(t,t.edit.current,s),t.edit.next=!0,"Tex"===s&&(Pe(t,t.edit.current,!0),_e(t,t.edit.current,"Tex",!0)),s>=t.settings.maxScore?(Pe(t,t.edit.current),_e(t,t.edit.current,0,!0)):(Pe(t,t.edit.current,!0),_e(t,t.edit.current,t.settings.maxScore,!0)))},setMatchResult({state:t,commit:e},s){const i=t.edit.current[0],o=t.edit.current[1],r=t.edit.current[2],a=t.edit.current[3],n=t.matches[i][o][r];"single"!==n.status&&"ready1"!==n.status&&"ready2"!==n.status&&(ye(t,{}),t.edit.next?(ve(t,i,o,r,1-a,s),t.edit.next=!1,s>=t.settings.maxScore&&-1===["win1","win2"].indexOf(t.matches[i][o][r].status)&&be(t,i,o,r,a)):(ve(t,i,o,r,a,s),t.edit.next=!0,s>=t.settings.maxScore||"Tex"===s?(be(t,i,o,r,1-a),ve(t,i,o,r,1-a,"Tex")):(be(t,i,o,r,1-a),ve(t,i,o,r,1-a,t.settings.maxScore))),setTimeout(()=>fe(t,{order:[i,o,r,a]})))},moveObjects({state:t,commit:e},{dx:s,dy:o}){t.edit.itemsToMove.forEach(e=>{if(e.seeds){const[i,r,a]=e.order,[n,l]=e.seeds;e.position=[t.mesh[r][2*a]=e.position[0]+s,t.mesh[r][2*a+1]=e.position[1]+o];let c="win1"===e.status||"win2"===e.status,d="win1"===e.status||"win2"===e.status||"ready"===e.status;e.curves&&(Ae(e.curves[0],t,n,e.order[0],e.order[1],e.order[2],0,{color:d||"ready1"===e.status?t.colors[n]:null,shiftX:e.curvesShiftX[0]}),Ae(e.curves[1],t,l,e.order[0],e.order[1],e.order[2],1,{color:d||"ready2"===e.status?t.colors[l]:null,shiftX:e.curvesShiftX[1]})),We(t,i,r,a,n,l,c)}else e[1]+=s,e[2]+=o,console.log(e.join(", ")),i["a"].set(t.medias,0,t.medias[0])}),console.log("------");let r="";t.mesh.forEach(t=>{r+="["+t.join(", ")+"],\n"}),console.log(r.slice(0,-2)+"\n")},saveResults({state:t,commit:e}){ne.saveState(t.settings.base,["seeds.json","scores.json"],[JSON.stringify({seeds:t.seeds}).replace("[[","[\n[").replace(/\],\[/gm,"],\n["),JSON.stringify({scores:t.scores}).replace("[[[","[\n[[").replace(/\]\],\[/gm,"]],\n[")])},saveAllResults({state:t,commit:e}){"pairs"===t.settings.type?ne.saveState(t.settings.base,["info.json","players.json","medias.json","mesh.json","seeds.json","scores.json"],[JSON.stringify({...t.info}).replace("[[[","[\n[[").replace(/\]\],\[/gm,"]],\n["),JSON.stringify({players:t.players0.map(({short:t,currentRating:e,...s})=>s),pairs:t.players.map(({location:t,location2:e,currentRating:s,...i})=>i)}).replace("{","{\n").replace("[","[\n").replace(/",/gm,'",\n').replace(/"pairs"/gm,'\n"pairs"').replace(/}/gm,"\n}").replace(/{/gm,"{\n"),JSON.stringify({medias:t.medias}).replace("[[[","[\n[[").replace(/\]\],\[/gm,"]],\n["),JSON.stringify({mesh:t.mesh}).replace("[[[","[\n[[").replace(/\]\],\[/gm,"]],\n["),JSON.stringify({seeds:t.seeds}).replace("[[[","[\n[[").replace(/\]\],\[/gm,"]],\n["),JSON.stringify({scores:t.scores}).replace("[[[","[\n[[").replace(/\]\],\[/gm,"]],\n[")]):ne.saveState(t.settings.base,["info.json","players.json","medias.json","mesh.json","seeds.json","scores.json"],[JSON.stringify({...t.info}).replace("[[[","[\n[[").replace(/\]\],\[/gm,"]],\n["),JSON.stringify({players:t.players.map(({short:t,currentRating:e,...s})=>s)}).replace("{","{\n").replace("[","[\n").replace(/",/gm,'",\n').replace(/{/gm,"{\n"),JSON.stringify({medias:t.medias}).replace("[[[","[\n[[").replace(/\]\],\[/gm,"]],\n["),JSON.stringify({mesh:t.mesh}).replace("[[[","[\n[[").replace(/\]\],\[/gm,"]],\n["),JSON.stringify({seeds:t.seeds}).replace("[[[","[\n[[").replace(/\]\],\[/gm,"]],\n["),JSON.stringify({scores:t.scores}).replace("[[[","[\n[[").replace(/\]\],\[/gm,"]],\n[")])},saveFiles({state:t,commit:e}){"pairs"===t.settings.type?(ne.saveFile("players.json",JSON.stringify({players:t.players0.map(({short:t,currentRating:e,...s})=>s),pairs:t.players.map(({location:t,location2:e,currentRating:s,...i})=>i)}).replace("{","{\n").replace("[","[\n").replace(/",/gm,'",\n').replace(/"pairs"/gm,'\n"pairs"').replace(/}/gm,"\n}").replace(/{/gm,"{\n")),ne.saveFile("scores.json",JSON.stringify({scores:t.scores}).replace("[[[","[\n[[").replace(/\]\],\[/gm,"]],\n["))):(ne.saveFile("seeds.json",JSON.stringify({seeds:t.seeds}).replace("[[","[\n[").replace(/\],\[/gm,"],\n[")),ne.saveFile("scores.json",JSON.stringify({scores:t.scores}).replace("[[[","[\n[[").replace(/\]\],\[/gm,"]],\n[")))},restoreFromStorage({state:t,commit:e}){t.seeds=JSON.parse(localStorage["seeds"]),t.scores=JSON.parse(localStorage["scores"]),ue(t)},savePlayers({state:t,commit:e}){},centerMatch({state:t,commit:e}){if(t.edit.readyMatches.length){const e=t.zoomer;t.edit.centeredMatch=(t.edit.centeredMatch+1)%t.edit.readyMatches.length;const a=t.edit.readyMatches[t.edit.centeredMatch];var s=e.getSizes(),i=(e.getPan(),document.querySelector("#match-"+a.order[0]+"-"+a.order[1]+"-"+a.order[2]).getBoundingClientRect());console.log(i);e.getZoom();var o=i.x+i.width/2,r=i.y+i.height/2;s.width,s.height}}}});function ce(t,e){if(t.players0=[...t.players],e)return void(t.players=e);t.players=[];const s=2*Math.floor(t.players0.length/2);for(let i=0;i<s/2;i++){let e=t.players0[2*i],s=t.players0[2*i+1],o=e.currentRating,r=s.currentRating,a="average"===t.settings.rtype?.5:(o-r)/(o+r)/2.5+.5,n="sum"===t.settings.rtype?o+r:Math.round(o*(1-a)+r*a);t.players[i]={name:e.name,name2:s.name,logo:e.logo,logo2:s.logo,location:e.location,location2:s.location,short:e.short+" и "+s.short,currentRating:Math.round(n),rating:Math.round(n)}}t.players.sort((t,e)=>{return e.currentRating-t.currentRating}),console.log(t.players,t.players0)}function de(t,e){const s=new Set;if(t.players.map(e=>{e.currentRating=+e.rating;const i=e.name.split(" ");e.short=i[0],i.length>1&&("fullName"===t.settings.shortType?e.short=i[1]+" "+i[0].substr(0,1)+".":"onlyName"===t.settings.shortType?e.short=i[1]:"full2"===t.settings.shortType?e.short+=" "+i[1]:e.short+=" "+i[1].substr(0,1)+".",e.logo&&(e.logo=t.settings.base+e.logo)),s[e.short]&&i.length>2&&(e.short+=" "+i[2].substr(0,1)+".",s[e.short]&&(e.short+=" 2")),s[e.short]=i}),e)if(!0===e)t.players.sort((t,e)=>{return e.rating-t.rating});else{e.forEach((e,s)=>{-1===e&&Ce(t,s)}),t.seeds=t.seeds.map(t=>t.map(t=>t<0?t:e[t])),console.log("------",t.seeds);let s="";t.seeds.forEach(t=>{s+="["+t.join(", ")+"],\n"}),console.log(s.slice(0,-2)+"\n")}}function ue(t){t.curves=[],t.matches=[],t.groups=[],t.readyMatches=[],t.stages?t.stages.forEach((e,s)=>{console.log(e,s),"groups"===e&&(i["a"].set(t.groups,s,[]),i["a"].set(t.places,s,[]),he(t,s,t.groups[s],t.mesh[s],t.seeds[s],t.scores[s],t.places[s],t.players)),"finals"===e&&(i["a"].set(t.matches,s,[]),i["a"].set(t.places,s,[]),ge(t,s,t.matches[s],t.mesh[s],t.seeds[s],t.scores[s],t.places[s],t.players))}):ge(t,0,t.mesh,t.seeds,t.scores)}function he(t,e,s,o,r,a,n,l){console.log(e,o,o.length,r,a);for(let c=0;c<o.length;c++){if(!r[c])continue;const l=r[c],d=l.length;let u=a[c];u||(i["a"].set(a,c,[]),u=a[c]),u.length=d;for(let t=0;t<d;t++){u[t]||i["a"].set(u,t,[]);for(let e=0;e<d;e++)e===t?u[t][e]&&i["a"].set(u[t],e,null):u[t][e]||i["a"].set(u[t],e,[0,0,"",0,0])}s.push({index:c,stage:e,order:[e,c],seeds:r[c],position:[o[c][0],o[c][1]]});const h=r[c].length;n.push(Array(h)),me(t,r[c],a[c],n[c],e,c)}}function me(t,e,s,o,r,a){let n=0;const l=[],c=s.length;for(let i=0;i<c;i++){l[i]={min:0,max:0,index:i};for(let t=0;t<c;t++){const e=s[i][t];e&&("win1"===e[2]?(l[i].min+=2,l[i].max+=2,n++):"win2"===e[2]?(l[i].min+=1,l[i].max+=1,n++):l[i].max+=2)}}if(n<c)l.forEach((t,e)=>{i["a"].set(o,t.index,[1,c])});else if(n!==c*c-c){for(let t=0;t<l.length;t++){let e=l.length,s=1,i=l[t].min,o=l[t].max;for(let r=0;r<l.length;r++)t!==r&&(o<l[r].min&&s++,i>l[r].max&&e--);l[t].minPlace=e,l[t].maxPlace=s}l.forEach((e,s)=>{if(i["a"].set(o,e.index,e.minPlace===e.maxPlace?[e.minPlace]:[e.maxPlace,e.minPlace]),e.minPlace===e.maxPlace&&0===r)if(e.maxPlace<=3){console.log(333,r,a,s,t.seeds[r+1][a]);const o=0===a?2*(e.maxPlace-1):2*(e.maxPlace-1)+1;i["a"].set(t.seeds[r+1][0],o,t.seeds[r][a][e.index])}else{const s=0===a?2*(e.maxPlace-4):2*(e.maxPlace-4)+1;i["a"].set(t.seeds[r+1][1],s,t.seeds[r][a][e.index])}}),l.sort((t,e)=>t.maxPlace-e.maxPlace);for(let t=0;t<l.length-1;t++){let e=pe(s,l,t,t+1);if(e>0){for(let s=t;s<t+e+1;s++)i["a"].set(o,l[s].index,l[s].split?[l[s].split]:[s+1]),s<3&&l[s].split;t+=e}}}else{l.sort((t,e)=>e.max-t.max);for(let t=0;t<l.length-1;t++)t+=pe(s,l,t,t+1);l.forEach((e,s)=>{if(i["a"].set(o,e.index,e.split?[e.split]:[s+1]),0===r)if(e.maxPlace=s+1,e.maxPlace<=3){console.log(333,r,a,s,t.seeds[r+1][a]);const o=0===a?2*(e.maxPlace-1):2*(e.maxPlace-1)+1;i["a"].set(t.seeds[r+1][0],o,t.seeds[r][a][e.index])}else{const s=0===a?2*(e.maxPlace-4):2*(e.maxPlace-4)+1;i["a"].set(t.seeds[r+1][1],s,t.seeds[r][a][e.index])}s<3&&e.split})}}function pe(t,e,s,i){if(s+1>=e.length||e[s].min!==e[s].max||e[s+1].min!==e[s+1].max||e[s].max!==e[s+1].max)return 0;let o=2;while(s+o<e.length&&e[s].max===e[s+o].max&&e[s+o].min===e[s+o].max)o++;if(s>0&&e[s-1].max===e[s].max||s+o+1<e.length&&e[s+o+1].max===e[s].max)return 0;if(console.log("resolving "+(s+1)+"-"+(s+o)+", score: "+e[s].max),2===o){let i=t[e[s].index][e[s+1].index],r=i[0]-i[1];e[s].max+=r/1e3,e.splice(s,0,...e.splice(s,o).sort((t,e)=>e.max-t.max)),console.log("personal "+(e[s].index+1)+" "+(r>0?"+"+r:r)+"("+(e[s+1].index+1)+")")}else{for(let a=s;a<s+o;a++){let i=0,r=e[a].index+1+":";for(let n=s;n<s+o;n++){if(a===n)continue;let s=t[e[a].index][e[n].index],o=s[0]-s[1];i+=o,r+=" "+(o>0?"+"+o:o)+"("+(e[n].index+1)+")"}e[a].max+=i/100,console.log(r+" = "+(i>0?"+"+i:i))}let i=e.splice(s,o).sort((t,e)=>e.max-t.max);e.splice(s,0,...i);let r=e[s].max;for(let a=s+1;a<s+o;a++)if(e[a].max===r)if(a+1===s+o||e[a+1].max!==r){let s=t[e[a-1].index][e[a].index],i=s[0]-s[1];e[a-1].max+=i/1e3,e.splice(a-1,0,...e.splice(a-1,2).sort((t,e)=>e.max-t.max)),console.log("personal "+(e[a-1].index+1)+" "+(i>0?"+"+i:i)+"("+(e[a].index+1)+")")}else{let t=a;const i=[];i.push(e[a-1]);while(a<s+o&&e[a].max===r)i.push(e[a]),a++;t+=".."+a,i.forEach((e,s)=>e.split=t)}else r=e[a].max}return o-1}function ge(t,e,s,i,o,r,a,n){for(let l=0;l<o.length;l++){let a=[],c=o[l];r[l]||(r[l]=[]),console.log(c,r[l]);const d=c.length/2;for(let s=0;s<d;s+=1){let o=c[2*s],u=c[2*s+1];if(o<0||u<0){0===l&&o>=0?a.push({order:[e,l,s],seeds:[o,-1],logos:[n[o].logo||""],names:[n[o].short],position:[i[l][2*s],i[l][2*s+1]],ratings:[Math.round(n[o].rating)],scores:[""],status:"single"}):0===l&&u>=0?a.push({order:[e,l,s],seeds:[u,-1],logos:[n[u].logo||""],names:[n[u].short],position:[i[l][2*s],i[l][2*s+1]],ratings:[Math.round(n[u].rating)],scores:[""],status:"single"}):a.push(null);continue}let h=0===l?"ready":"";r[l][s]?h=r[l][s][2]:r[l][s]=[0,0,h];let m="win1"===h||"win2"===h||"ready"===h,p=null,g=null;if(l>0){g=[je(l,s,d),je(l,s,d)-.2];let i=[m||"ready1"===h?t.colors[o]:null,m||"ready2"===h?t.colors[u]:null];2===l&&0===s&&console.log("stat",h,m,r[l],i),p=[Ee(t,o,e,l,s,0,{color:i[0],shiftX:g[0]}),Ee(t,u,e,l,s,1,{color:i[1],shiftX:g[1]})],p[0]&&t.curves.push(p[0]),p[1]&&t.curves.push(p[1])}if(n.length<=o){Ce(t,o);continue}if(n.length<=u){Ce(t,u);continue}const f={order:[e,l,s],seeds:[o,u],curves:p,curvesShiftX:g,logos:[n[o].logo||"",n[u].logo||""],names:[n[o].short,n[u].short],position:[i[l][2*s],i[l][2*s+1]],ratings:[Math.round(n[o].currentRating),Math.round(n[u].currentRating)],scores:r[l][s],status:h};if(a.push(f),"win1"===h||"win2"===h){const t=Ie(+n[o].rating,+n[u].rating,r[l][s]);n[o].currentRating+="win1"===h?t[0]:t[1],n[u].currentRating+="win1"===h?t[1]:t[0]}else"ready"===h&&t.edit.readyMatches.push(f)}s.push(a)}console.log(s),a.length=o.length;for(let l=0;l<o[0].length;l++){let s=o.length-1;while(o[s][l]<0)s--;const i=o[s][l],r=t.matches[e][s][Math.floor(l/2)];"win1"!==r.status&&"win2"!==r.status||(a[l]={seed:i,order:[e,s,Math.floor(l/2),l%2?1:0],position:[r.position[0]+t.settings.matchWidth+10,r.position[1]+(l%2?30:0)],rating:Math.round(n[i].currentRating),delta:Math.round(n[i].currentRating)-Math.round(n[i].rating),place:"win1"===r.status?l+1:l%2?l:l+2},l<3&&setTimeout(()=>document.querySelectorAll("#player"+i+":not(.empty)").forEach(t=>t.classList.add("place--"+(l+1)))))}}function fe(t,{order:e,$event:s}){const i=e[0],o=e[1],r=e[2],a=e[3];console.log("g="+o,"j="+r,"seeds:",t.matches[i][o][r].seeds.join(","),"status:",t.matches[i][o][r].status,"position:",t.matches[i][o][r].position.join(","),"colors:",t.colors[t.matches[i][o][r].seeds[0]],t.colors[t.matches[i][o][r].seeds[1]]),!s||o===t.edit.current[0]&&r===t.edit.current[1]&&a===t.edit.current[2]||(t.edit.current=e,t.edit.type="match",t.edit.over=[t.matches[i][o][r].seeds[a]]),document.querySelectorAll("#player"+t.matches[i][o][r].seeds[a]+":not(.empty)").forEach(t=>t.classList.add("over"))}function ye(t,{order:e,$event:s}){s&&t.edit.current&&(t.edit.next=!1),document.querySelectorAll("#player"+t.edit.over[0]).forEach(t=>t.classList.remove("over"))}function ve(t,e,s,o,r,a){t.scores[e][s][o][r]=a,i["a"].set(t.matches[e][s][o].scores,r,a),localStorage["scores"]=JSON.stringify(t.scores),localStorage["seeds"]=JSON.stringify(t.seeds)}function be(t,e,s,i,o){const r=t.matches[e][s][i],a=r.status,n=o?"win2":"win1";r.status=n,t.scores[s][i][2]=n;let[l,c]=r.seeds;if(s+1<t.seeds.length&&("win2"===a&&"win1"===n||"win2"!==a&&"win2"===n))for(let d=s+1;d<t.seeds.length;d++){let e=t.seeds[d].indexOf(l),s=t.seeds[d].indexOf(c);Te(t,d,e,s,l,c)}Me(t,e,s,i,l,c),We(t,e,s,i,l,c,!0)}function xe(t,{order:e,$event:s}){const i=e[0],o=e[1],r=e[2],a=e[3],n=t.seeds[i][o][r],l=t.seeds[i][o][a];!s||i===t.edit.current[0]&&o===t.edit.current[1]&&r===t.edit.current[2]&&a===t.edit.current[3]||(console.log("s="+i,"g="+o,"i="+r,"j="+a),t.edit.current=e,t.edit.type="group",t.edit.over=[...e]),document.querySelectorAll("#player"+n+":not(.empty)").forEach(t=>t.classList.add("over")),document.querySelectorAll("#player"+l+":not(.empty)").forEach(t=>t.classList.add("over")),document.querySelectorAll("#group-"+i+"-"+o+"-"+r+"-"+a+":not(.empty)").forEach(t=>t.classList.add("group-cell-over")),document.querySelectorAll("#group-"+i+"-"+o+"-"+a+"-"+r+":not(.empty)").forEach(t=>t.classList.add("group-cell-over"))}function we(t,{order:e,$event:s}){if(s&&t.edit.current&&(t.edit.next=!1),t.edit.over&&4===t.edit.over.length){const e=t.edit.over[0],s=t.edit.over[1],i=t.edit.over[2],o=t.edit.over[3],r=t.seeds[e][s][i],a=t.seeds[e][s][o];document.querySelectorAll("#player"+r+":not(.empty)").forEach(t=>t.classList.remove("over")),document.querySelectorAll("#player"+a+":not(.empty)").forEach(t=>t.classList.remove("over")),document.querySelectorAll("#group-"+e+"-"+s+"-"+i+"-"+o+":not(.empty)").forEach(t=>t.classList.remove("group-cell-over")),document.querySelectorAll("#group-"+e+"-"+s+"-"+o+"-"+i+":not(.empty)").forEach(t=>t.classList.remove("group-cell-over"))}}function Se(t,e){const s=e[0],o=e[1],r=e[2],a=e[3],n=+new Date;""===t.scores[s][o][r][a][2]?(t.scores[s][o][r][a][2]="progress",t.scores[s][o][a][r][2]="progress",t.scores[s][o][r][a][3]=n,t.scores[s][o][a][r][3]=n):"progress"===t.scores[s][o][r][a][2]&&(t.scores[s][o][r][a][2]="",t.scores[s][o][a][r][2]="",t.scores[s][o][r][a][3]=0,t.scores[s][o][a][r][3]=0),i["a"].set(t.scores[s][o][a],r,t.scores[s][o][a][r])}function _e(t,e,s,o=!1){const r=e[0],a=e[1],n=e[2],l=e[3];i["a"].set(t.scores[r][a][n][l],o?1:0,s),i["a"].set(t.scores[r][a][l][n],o?0:1,s),me(t,t.seeds[r][a],t.scores[r][a],t.places[r][a],r,a)}function $e(t,e){const s=e[0],o=e[1],r=e[2],a=e[3];i["a"].set(t.scores[s][o][r],a,[0,0,"",0,0]),i["a"].set(t.scores[s][o][a],r,[0,0,"",0,0]),me(t,t.seeds[s][o],t.scores[s][o],t.places[s][o])}function Pe(t,e,s=!1){const o=e[0],r=e[1],a=e[2],n=e[3],l=+new Date;if(i["a"].set(t.scores[o][r][a][n],2,s?"win2":"win1"),i["a"].set(t.scores[o][r][n][a],2,s?"win1":"win2"),i["a"].set(t.scores[o][r][a][n],4,l),i["a"].set(t.scores[o][r][n][a],4,l),0===t.scores[o][r][a][n][3]){const e=3e5;i["a"].set(t.scores[o][r][a][n],3,l-e),i["a"].set(t.scores[o][r][n][a],3,l-e)}}function Te(t,e,s,i,o,r){-1!==s&&(t.seeds[e][s]=r,ke(t,e,s,r)),-1!==i&&(t.seeds[e][i]=o,ke(t,e,i,o))}function ke(t,e,s,i,o){if(!t.matches)return;const r=t.matches[e][s][Math.floor(i/2)];if(!r)return;console.log(r,s,Math.floor(i/2));let a="win1"===r.status||"win2"===r.status,n="single"===r.status;i%2&&!n?(r.seeds[1]=o,r.logos[1]=t.players[o].logo,r.names[1]=t.players[o].short,r.ratings[1]=Math.round(t.players[o].rating),r.curves&&Ae(r.curves[1],t,o,r.order[0],r.order[1],r.order[2],1,{color:a?t.colors[o]:null,shiftX:r.curvesShiftX[1]})):(r.seeds[0]=o,r.logos[0]=t.players[o].logo,r.names[0]=t.players[o].short,r.ratings[0]=Math.round(t.players[o].rating),r.curves&&Ae(r.curves[0],t,o,r.order[0],r.order[1],r.order[2],0,{color:a?t.colors[o]:null,shiftX:r.curvesShiftX[0]}))}function Ce(t,e){let s=0;while(s<t.seeds.length){let i=t.seeds[s].indexOf(e);if(-1!==i)if(i%2)t.seeds[s][i]=-1,s>0&&(t.seeds[s][i-1]=-1);else{let o=t.seeds[s][i+1];for(let i=s+1;i<t.seeds.length;i++){let s=t.seeds[i].indexOf(e),r=t.seeds[i].indexOf(o);Te(t,i,s,r,e,o)}t.seeds[s][i]=-1,s>0&&(t.seeds[s][i+1]=-1)}s++}}const Oe=!1;function Ve(t,e,s,i=!0){let o=t.matches[e[0]][e[1]][e[2]].seeds[e[3]],r=t.matches[s[0]][s[1]][e[2]].seeds[s[3]];if(Oe){for(let t=e[0];t<De.length;t++){let e=De[t].indexOf(o),s=De[t].indexOf(r);-1!==e&&-1!==s?(De[t][e]=r,De[t][s]=o):-1!==e?De[t][e]=r:-1!==s&&(De[t][s]=o)}ue(t)}else{for(let s=i?0:e.index+1;s<t.seeds.length;s++){let e=t.seeds[s].indexOf(o),i=t.seeds[s].indexOf(r);Te(t,s,e,i,o,r)}localStorage["seeds"]=JSON.stringify(t.seeds)}}function je(t,e,s){return 1===t&&e>=s/2?1.7*(.75-e/s):2===t&&e>3*s/4?1.1*(1.2-e/s):2===t&&e>s/2?1.8*(.75-e/s):null}function Me(t,e,s,i,o,r){if(console.log(s,i,o,r),s<t.seeds.length-1){let{i0:i,j0:a}=Re(t,o,e,s);if(-1!==o&&-1!==a){const s=t.matches[e][i][Math.floor(a/2)];a%2?"ready1"===s.status?s.status="ready":""!==s.status&&"progress"!==s.status||(s.status="ready2"):"ready2"===s.status?s.status="ready":""!==s.status&&"progress"!==s.status||(s.status="ready1"),t.scores[e][i][Math.floor(a/2)]&&(t.scores[e][i][Math.floor(a/2)][2]=s.status,console.log(t.scores[e][i][Math.floor(a/2)]))}if(({i0:i,j0:a}=Re(t,r,e,s)),-1!==r&&-1!==a){const s=t.matches[e][i][Math.floor(a/2)];a%2?"ready1"===s.status?s.status="ready":""!==s.status&&"progress"!==s.status||(s.status="ready2"):"ready2"===s.status?s.status="ready":""!==s.status&&"progress"!==s.status||(s.status="ready1"),t.scores[e][i][Math.floor(a/2)]&&(t.scores[e][i][Math.floor(a/2)][2]=s.status)}}}function We(t,e,s,i,o,r,a){if(s<t.seeds.length-1){let{i0:i,j0:n}=Re(t,o,e,s);if(-1!==o&&-1!==n){const s=t.matches[e][i][Math.floor(n/2)];n%2?Ae(s.curves[1],t,o,s.order[0],s.order[1],1,{color:a?t.colors[o]:null,shiftX:s.curvesShiftX[1]}):Ae(s.curves[0],t,o,s.order[0],s.order[1],0,{color:a?t.colors[o]:null,shiftX:s.curvesShiftX[0]})}if(({i0:i,j0:n}=Re(t,r,e,s)),-1!==r&&-1!==n){const s=t.matches[e][i][Math.floor(n/2)];n%2?Ae(s.curves[1],t,r,s.order[0],s.order[1],1,{color:a?t.colors[r]:null,shiftX:s.curvesShiftX[1]}):Ae(s.curves[0],t,r,s.order[0],s.order[1],0,{color:a?t.colors[r]:null,shiftX:s.curvesShiftX[0]})}}}function Ae(t,e,s,i,o,r,a,{color:n,shiftX:l}){let{i0:c,j0:d}=Le(e,s,i,o);const u=0===c&&"single"===e.matches[i][c][Math.floor(d/2)].status?.5:d%2;d=d%2?d-1:d,t.d=Ne(e.mesh[i][c][d]+e.settings.matchWidth,e.mesh[i][c][d+1]+e.settings.matchHeight/4+30*u,e.mesh[i][o][2*r]+0,e.mesh[i][o][2*r+1]+e.settings.matchHeight/4+30*a,l),t.color=n||e.settings.defaultCurveColor,t.dash=n?0:2}function Ee(t,e,s,i,o,r,{color:a,shiftX:n}){let{i0:l,j0:c}=Le(t,e,s,i);if(-1===c)return console.error("wrong order",e,i,o),null;const d=0===l&&"single"===t.matches[s][l][Math.floor(c/2)].status?.5:c%2;return c=c%2?c-1:c,{d:Ne(t.mesh[s][l][c]+t.settings.matchWidth,t.mesh[s][l][c+1]+(t.settings.matchHeight/4+30*d),t.mesh[s][i][2*o]+0,t.mesh[s][i][2*o+1]+t.settings.matchHeight/4+30*r,n),color:a||t.settings.defaultCurveColor,dash:a?0:2}}function Ne(t,e,s,i,o){const r=.755*(s-t),a=Math.abs(i-e),n=a>200?15*Math.log(a):0;return"M"+t+","+e+" C"+(t+r+.6*n+o*r)+","+e+" "+(s-r-n+o*r)+","+i+" "+s+","+i}function Ie(t,e,[s,i,o]){if(s===i)return[0,0];const r=Math.abs(s-i),a=1===r?.5:2===r?.7:1,n=s>i?t:e,l=s<i?t:e,c=n-l;if(c<100){const t=(10-(n-l)/10)*a;return[t,-t/2]}return 2===r?[-c/100/2,c/100]:1===r?[-c/20/2,c/20]:[0,0]}function Re(t,e,s,i){let o=-1;while(i<t.seeds[s].length-1)if(i++,o=t.seeds[s][i].indexOf(e),-1!==o)return{i0:i,j0:o};return{i0:i,j0:o}}function Le(t,e,s,i){let o=-1;while(i>0)if(i--,o=t.seeds[s][i].indexOf(e),-1!==o)return{i0:i,j0:o};return{i0:i,j0:o}}function Ke(t,e){e&&(t.settings.defaultZoomX=e.x,t.settings.defaultZoomY=e.y,t.settings.defaultZoomScale=e.scale);const s=t.zoomer;if(s.pan({x:t.settings.defaultZoomX,y:t.settings.defaultZoomY}),s.zoomAtPoint(t.settings.defaultZoomScale,{x:0,y:0}),localStorage["zoom"]){const t=JSON.parse(localStorage["zoom"]);ee.currentRoute.params["section"]===t.section&&(t.scale&&t.scale>.1&&t.scale<3&&s.zoom(t.scale),t.x&&t.y&&s.pan({x:t.x,y:t.y}))}}const De=[[0,15,8,7,4,11,12,3,2,13,10,5,6,9,14,1],[0,8,4,12,2,10,6,14,15,7,11,3,13,5,9,1],[0,4,2,6,10,15,14,11,8,13,12,9,7,3,5,1],[0,2,-1,-1,10,14,8,12,15,11,13,9,7,5,3,1],[-2,-2,4,10,6,8,14,12,15,13,11,9,-1,-1,-1,-1],[-2,-2,4,6,10,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-2,-2,2,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,2,4,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]];var ze=s("9483");Object(ze["a"])("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh."),setTimeout(()=>{window.location.reload(!0)},1e3)},offline(){console.log("No internet connection found. App is running in offline mode.")},error(t){console.error("Error during service worker registration:",t)}});var Be=s("f309");i["a"].use(Be["a"]);var Ge=new Be["a"]({icons:{iconfont:"mdi"}}),Je=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"silentbox-single",attrs:{src:t.src},on:{click:t.openSilentBoxOverlay}},[t._t("default",[s("img",{attrs:{src:t.getThumnail(t.src),width:t.thumbnailWidth,height:t.thumbnailHeight}})]),s("silentbox-overlay")],2)},Xe=[],qe=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"silentbox-item",attrs:{src:t.src},on:{click:t.openSilentBoxOverlay}},[t._t("default",[s("img",{attrs:{src:t.getThumnail(t.src),width:t.thumbnailWidth,height:t.thumbnailHeight}})])],2)},Fe=[],He={methods:{getYoutubeVideoId(t){let e=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/,s=t.match(e);return void 0!==s&&void 0!==s[7]&&s[7]},getVimeoVideoId(t){return/(vimeo(pro)?\.com)\/(?:[^\d]+)?(\d+)\??(.*)?$/.exec(t)[3]}}},Ze={mixins:[He],methods:{getThumnail(t){if(t.includes("youtube.com")||t.includes("youtu.be")){let e=this.getYoutubeVideoId(t);return"https://img.youtube.com/vi/"+e+"/hqdefault.jpg"}if(t.includes("vimeo.com")){let t=this.httpGet("https://vimeo.com/api/v2/video/54802209.json");return t[0].thumbnail_medium}return t},httpGet(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),JSON.parse(e.responseText)}}},Ue={name:"SilentboxItem",mixins:[Ze],props:{mid:{type:String,required:!0},src:{type:String,required:!0},autoplay:{type:Boolean,default(){return!1}},description:String,position:{},thumbnailWidth:{type:String,default:"200px"},thumbnailHeight:{type:String,default:"150px"},hideControls:{type:Boolean,default(){return!1}}},computed:{embedUrl(){return null!==this.src?this.src:null}},methods:{closeSilentBoxOverlay(){this.$parent.$emit("closeSilentboxOverlay")},openSilentBoxOverlay(){let t=this.$parent.items.list.findIndex(t=>t.src===this.src);this.$parent.$emit("openSilentboxOverlay",{url:this.embedUrl,position:t,autoplay:this.autoplay,description:this.description})}},created(){this.$parent.items.list.push({mid:this.mid,src:this.src,autoplay:this.autoplay,desc:this.description,position:this.position})}},Ye=Ue,Qe=(s("6f0c"),Object(l["a"])(Ye,qe,Fe,!1,null,null,null)),ts=Qe.exports,es=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.isVisible,expression:"isVisible"}],attrs:{id:"silentbox-overlay"}},[s("div",{attrs:{id:"silentbox-overlay__background"},on:{click:function(e){return e.stopPropagation(),t.closeSilentboxOverlay(e)}}}),s("div",{attrs:{id:"silentbox-overlay__content"}},[s("div",{attrs:{id:"silentbox-overlay__embed"}},[s("div",{attrs:{id:"silentbox-overlay__container"},on:{click:function(t){t.stopPropagation()}}},[t.tubeVideo?s("keep-alive",[s("youtube",{ref:"tube",attrs:{"video-id":t.getEmbedUrl,width:"100%",height:"100%"},on:{ready:t.onReady,playing:t.onStartPlaying,paused:t.onPaused}})],1):t._e(),s("keep-alive",[s("audio-player",{ref:"audioPlayer",attrs:{current:t.audioCurrent}})],1),t.tubeVideo&&t.tubeData?s("scoreboard",{attrs:{score1:t.scoreArray[0],score2:t.scoreArray[1],record1:t.scoreArray[2],record2:t.scoreArray[3],status:t.scoreStatus,id:"board"}}):t._e(),t.vimeoVideo?s("iframe",{attrs:{width:"100%",height:"100%",src:t.getEmbedUrl,frameborder:"0",allow:t.getAutoplayState,allowfullscreen:""}}):t._e(),t.vimeoVideo||t.tubeVideo?t._e():s("img",{attrs:{width:"auto",height:"auto",src:t.getEmbedUrl}})],1),this.$parent.description?s("p",{attrs:{id:"silentbox-overlay__description"},on:{click:function(t){t.stopPropagation()}}},[t._v(t._s(this.$parent.description))]):t._e()])]),s("div",{attrs:{id:"silentbox-overlay__close-button",role:"button",tabindex:"3"},on:{click:function(e){return e.stopPropagation(),t.closeSilentboxOverlay(e)},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.closeSilentboxOverlay(e)}}},[s("div",{staticClass:"icon"})]),this.$parent.items.total>0?s("div",{attrs:{id:"silentbox-overlay__arrow-buttons"}},[s("div",{staticClass:"arrow arrow-previous",attrs:{role:"button",tabindex:"2"},on:{click:t.moveToPreviousItem,keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.moveToPreviousItem(e)}}}),s("div",{staticClass:"arrow arrow-next",attrs:{role:"button",tabindex:"1"},on:{click:t.moveToNextItem,keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.moveToNextItem(e)}}})]):t._e()])},ss=[],is=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",t._l(t.audios,(function(t,e){return s("audio",{key:"aPlayer"+e,attrs:{id:"aPlayer"+e,src:t,preload:"auto"}})})),0)},os=[];const rs=t=>{let e=new Date(1e3*t).toISOString().substr(11,8);return e};var as={name:"audioPlayer",props:{current:{type:String,default:""},autoPlay:{type:Boolean,default:!1}},computed:{duration:function(){return this.audio?rs(this.audio.duration):""},audioIndex:function(){return this.audios.indexOf(this.current)},audio:function(){return document.querySelector("#aPlayer"+this.audioIndex)}},watch:{current:{immediate:!0,handler(t,e){if(t&&(this.audios.includes(t)||this.audios.push(t),e)){const t=this.audios.indexOf(e),s=document.querySelector("#aPlayer"+t);s&&(s.pause(),s.currentTime=0)}}}},data(){return{audios:[],isMuted:!1,loaded:!1,playing:!1,paused:!1,percentage:0,currentTime:"00:00:00",totalDuration:0}},methods:{getDuration(){return!this.audio||!this.audio.readyState||this.audio.readyState<2?0:this.audio.duration},getPosition(){return!this.audio||!this.audio.readyState||this.audio.readyState<2?0:this.audio.currentTime},setPosition(t){!this.audio||!this.audio.readyState||this.audio.readyState<2||(this.audio.currentTime=t)},getVolume(){return!this.audio||!this.audio.readyState||this.audio.readyState<2?0:this.audio.volume},setVolume(t){if(!this.audio||!this.audio.readyState||this.audio.readyState<2)return 0;this.audio.volume=t},setPercentPosition(t){this.audio.currentTime=parseInt(this.audio.duration/100*t)},stop(){this.paused=this.playing=!1,this.audio&&(this.audio.pause(),this.audio.currentTime=0)},play(){return!this.audio||!this.audio.readyState||this.audio.readyState<2?Promise.resolve(null):(this.paused=!1,this.playing=!0,this.audio.play())},pause(){this.paused=!0,this.playing=!1,this.audio&&this.audio.readyState&&this.audio.pause()},download(){this.audio.pause(),window.open(this.file,"download")},mute(){this.isMuted=!this.isMuted,this.audio.muted=this.isMuted},reload(){this.audio.load()},preloadAudio(t){t.forEach(t=>{this.audios.includes(t)||this.audios.push(t)})}}},ns=as,ls=Object(l["a"])(ns,is,os,!1,null,null,null),cs=ls.exports,ds=s("e0ec"),us=s.n(ds),hs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"scoreboard"},[s("div",{staticClass:"team",class:{win:"win1"===t.status,lost:"win2"===t.status}},[t.videoState.chevrons[0]?s("div",{staticClass:"chevron",style:"background-color: "+t.videoState.chevrons[0]}):t._e(),s("div",{staticClass:"rank"},[t._v(t._s(t.videoState.ratings[0]))]),t.videoState.logos&&t.videoState.logos[0]?s("img",{staticClass:"logo",attrs:{src:t.videoState.logos[0]}}):t._e(),s("div",{staticClass:"name"},[t._v(t._s(t.videoState.names[0]))]),s("div",{staticClass:"score"},[t._v(t._s(t.score1))]),""===t.status?s("div",{staticClass:"record"},[t._v(t._s(t.record1))]):t._e()]),s("div",{staticClass:"divider"},[""===t.status?s("p",[t._v(t._s(t.videoState.subtitle))]):t._e()]),s("div",{staticClass:"team",class:{win:"win2"===t.status,lost:"win1"===t.status}},[t.videoState.chevrons[1]?s("div",{staticClass:"chevron",style:"background-color: "+t.videoState.chevrons[1]}):t._e(),s("div",{staticClass:"rank"},[t._v(t._s(t.videoState.ratings[1]))]),t.videoState.logos[1]?s("img",{staticClass:"logo",attrs:{src:t.videoState.logos[1]}}):t._e(),s("div",{staticClass:"name"},[t._v(t._s(t.videoState.names[1]))]),s("div",{staticClass:"score"},[t._v(t._s(t.score2))]),""===t.status?s("div",{staticClass:"record"},[t._v(t._s(t.record2))]):t._e()])])},ms=[],ps={props:{score1:{type:[Number,String],default:0},score2:{type:[Number,String],default:0},record1:{type:[Number,String],default:0},record2:{type:[Number,String],default:0},status:{type:String,default:""}},computed:{videoState(){return this.$store.state.video}}},gs=ps,fs=(s("c023"),Object(l["a"])(gs,hs,ms,!1,null,null,null)),ys=fs.exports;i["a"].use(us.a);var vs={name:"SilentboxOverlay",components:{Scoreboard:ys,audioPlayer:cs},mixins:[He],data(){return{videoId:"",videoState:null,vimeoVideo:!1,audioPlayer:null,tubePlayer:null,tubeVideo:!1,tubeData:!1,tubePosition:0,tubePositionLast:0,tubePositionIndex:0,tubePlaying:!1,audioPosition:0,audioPositionIndex:0,audioCurrent:"",lastPoint:null,interval:null,oldKeyDown:null,keyAdded:!1}},computed:{audioTime(){return this.videoState.audioTime||[0]},audioFiles(){return this.videoState.audio||[""]},scoreTime(){return this.videoState.scoreTime},score(){return this.videoState.score},scoreStatus(){if(!this.scoreTime||!this.scoreArray||this.scoreArray.length<=4)return"";const t=this.scoreArray[4];return"100"===t?"win1":"200"===t?"win2":""},scoreArray(){return this.scoreTime?-1===this.tubePositionIndex?this.score[this.score.length-1].split(" "):this.score[this.tubePositionIndex].split(" "):[0,0,0,0,0]},getEmbedUrl(){return this.handleUrl(this.$parent.embedUrl)},getAutoplayState(){return void 0!==this.$parent.autoplay&&!1!==this.$parent.autoplay?"autoplay":""},isVisible(){return void 0!==this.$parent.overlayVisibility&&!1!==this.$parent.overlayVisibility}},watch:{isVisible:function(t){void 0!==document&&this.bodyScrolling(),t?this.tubePlayer&&this.tubePlayer.playVideo():(this.tubeVideo&&this.stopTubeVideo(),null!==this.$route.params.media&&this.$router.push({params:{...this.$route.params,score:null,media:null}}))},tubePosition:function(t){if(!this.tubeData)return;let e=0;const s=this.scoreTime?this.scoreTime.length-1:0;while(e<s&&this.tubePosition>this.scoreTime[e])e++;const i=this.tubePosition<this.scoreTime[e]?e-1:e;if(i!==this.tubePositionIndex&&(this.tubePositionIndex=i,i>0)){const t=this.scoreArray[0]+":"+this.scoreArray[1]+"-"+this.scoreArray[2]+":"+this.scoreArray[3];t!==this.$route.params.score&&this.$router.replace({params:{...this.$route.params,score:t}})}},audioPosition:async function(t){if(!this.tubeData)return;let e=0;const s=this.audioTime?this.audioTime.length-1:0;while(e<s&&this.audioPosition>this.audioTime[e])e++;const i=this.audioPosition<this.audioTime[e]?e-1:e,o=t-this.audioTime[i];this.audioFiles[i]!==this.audioCurrent&&(this.audioPlayer.stop(),this.audioCurrent=this.audioFiles[i]),Math.abs(o-this.audioPlayer.getPosition())>3&&this.audioPlayer.setPosition(o),this.tubePlaying&&!this.audioPlayer.playing&&this.audioPlayer.play().catch(t=>{this.tubePlayer.pauseVideo()});const r=await this.tubePlayer.isMuted()?0:await this.tubePlayer.getVolume()/100;Math.abs(r-this.audioPlayer.getVolume())>.1&&this.audioPlayer.setVolume(r)}},methods:{initKey(){this.tubePlayer&&this.isVisible&&(this.oldKeyDown=document.onkeydown,document.querySelector("#silentbox-overlay iframe").onkeydown=document.onkeydown=t=>{if(t=t||window.event,console.log("scores",t.code),"BracketLeft"===t.code&&t.altKey)this.$store.dispatch("shrinkVideoPoint",{position:this.tubePosition});else if("BracketRight"===t.code&&t.altKey)this.$store.dispatch("showVideoPoint",{position:this.tubePosition});else if("BracketLeft"===t.code)this.$store.dispatch("addVideoPoint",this.lastPoint={k:t.shiftKey?0:2,position:this.tubePosition});else if("BracketRight"===t.code)this.$store.dispatch("addVideoPoint",this.lastPoint={k:t.shiftKey?1:3,position:this.tubePosition});else if("Backspace"===t.code)this.prevScore(),this.scoreTime.length>0&&(this.scoreTime.pop(),this.score.pop());else if("KeyR"===t.code&&this.lastPoint)this.scoreTime.length>0&&(this.scoreTime.pop(),this.score.pop()),this.lastPoint.k=this.lastPoint.k<2?1-this.lastPoint.k:5-this.lastPoint.k,this.$store.dispatch("addVideoPoint",this.lastPoint);else if("ArrowLeft"===t.code)this.prevScore();else if("ArrowRight"===t.code)this.nextScore();else if("Home"===t.code)this.firstScore();else if("End"===t.code)this.lastScore();else if("Space"===t.code)this.playPauseTubeVideo();else if("KeyM"===t.code&&t.altKey)this.audioPlayer.mute();else if("KeyV"===t.code&&t.altKey){const t=document.querySelector("#board");console.log(t),t&&(t.classList.contains("board-hide")?t.classList.remove("board-hide"):t.classList.add("board-hide"))}else if("KeyT"===t.code&&t.altKey){let t=0,e=0;for(let s=0;s<this.score.length;s++){let i=this.score[s].split(" ");if("0"===i[2]&&"0"===i[3]&&0!==s){e++;let i=new Date(1e3*this.scoreTime[s]).toISOString().substr(14,5),o=new Date(1e3*this.scoreTime[s]-t).toISOString().substr(14,5),r=new Date(t).toISOString().substr(14,5);console.log(e,"starts:",r,"length:",o,"ends:",i),t=1e3*this.scoreTime[s]}}}})},bodyScrolling(){let t=document.body;return this.isVisible&&!t.classList.contains("silentbox-is-opened")?t.classList.add("silentbox-is-opened"):!this.isVisible&&t.classList.contains("silentbox-is-opened")?t.classList.remove("silentbox-is-opened"):void 0},moveToNextItem(){this.$parent.nextItem(),this.$route.params.media!==this.$parent.mid&&this.$router.replace({params:{...this.$route.params,score:null,media:this.$parent.mid}})},moveToPreviousItem(){this.$parent.prevItem(),this.$route.params.media!==this.$parent.mid&&this.$router.replace({params:{...this.$route.params,score:null,media:this.$parent.mid}})},closeSilentboxOverlay(){this.$parent.$emit("closeSilentboxOverlay")},handleUrl(t){if(t.includes("youtube.com")||t.includes("youtu.be")){this.vimeoVideo=!1,this.tubeVideo=!0;const e=this.getYoutubeVideoId(t);return this.videoId!==e&&(this.videoId=e,this.tubeData=!1,this.tubePlayer&&this.isVisible&&this.startTubeVideo()),this.videoId}return t.includes("vimeo")?(this.tubeVideo&&this.stopTubeVideo(),this.tubeVideo=!1,this.vimeoVideo=!0,this.getVimeoVideo(t)):(this.tubeVideo&&this.stopTubeVideo(),this.tubeVideo=!1,this.vimeoVideo=!1,t)},getYoutubeVideo(t){let e="",s=this.getYoutubeVideoId(t);return s&&(e="https://www.youtube.com/embed/"+s+"?rel=0",this.$parent.autoplay&&(e+="&amp;autoplay=1"),this.$parent.showControls&&(e+="&amp;controls=0")),e},getVimeoVideo(t){let e="";const s=/(vimeo(pro)?\.com)\/(?:[^\d]+)?(\d+)\??(.*)?$/.exec(t)[3];return void 0!==s&&(e="https://player.vimeo.com/video/"+s+"?api=1",this.$parent.autoplay&&(e+="&autoplay=1")),e},onStartPlaying(){this.tubePlaying=!0,this.clearInterval(),this.interval=setInterval(this.updateScore,100),this.updateScore()},onPaused(){this.clearInterval(),this.tubePlaying=!1,this.audioPlayer.pause()},onReady(){this.tubePlayer=this.$refs.tube.player,this.audioPlayer=this.$refs.audioPlayer,this.isVisible&&this.startTubeVideo()},stopTubeVideo(){this.tubePlaying=!1,this.tubePlayer.pauseVideo(),this.audioPlayer.stop(),document.onkeydown=this.oldKeyDown,this.keyAdded=!1},startTubeVideo(){this.keyAdded||setTimeout(()=>this.initKey()),this.tubePlaying=!1,this.tubePlayer.playVideo(),this.loadBoard(this.videoId)},async playPauseTubeVideo(){const t=await this.tubePlayer.getPlayerState();t?this.tubePlayer.pauseVideo():this.tubePlayer.playVideo()},async loadBoard(t){await this.$store.dispatch("loadVideoBoard",t),this.videoState=this.$store.state.video,this.tubeData=!!this.videoState,this.tubeData&&(this.audioPlayer.preloadAudio(this.videoState.audio),this.audioFiles&&this.audioFiles[0]!==this.audioCurrent&&(this.audioCurrent=this.audioFiles[0]),this.firstScore(),this.tubePlayer&&this.$route.params.score&&this.seekScore())},seekScore(t){const e=this.$route.params.score.split(/[-: ]+/gi).slice(0,4).join(" "),s=this.score.findIndex(t=>0===t.indexOf(e));s>-1&&(this.tubePlayer.seekTo(this.scoreTime[s]),this.audioPlayer.setPosition(this.scoreTime[s]),this.audioPlayer.play())},updateScore(){this.tubePlayer&&this.tubeData&&this.isVisible||this.clearInterval(),this.tubePlayer.getCurrentTime().then(t=>{this.tubePosition=t,this.audioPosition=t})},updatePosition(t){this.tubePositionLast!==t&&(this.tubePositionLast=t)},prevScore(){this.tubePositionIndex>0&&(this.tubePositionIndex--,this.tubePlayer.seekTo(this.scoreTime[this.tubePositionIndex]))},nextScore(){this.tubePositionIndex<this.scoreTime.length-1&&(this.tubePositionIndex++,this.tubePlayer.seekTo(this.scoreTime[this.tubePositionIndex]))},firstScore(){this.tubePosition=0,this.tubePositionIndex=0,this.tubePlayer.seekTo(0)},lastScore(){this.tubePositionIndex=this.scoreTime.length-1,this.tubePlayer.seekTo(this.scoreTime[this.tubePositionIndex])},clearInterval(){this.interval&&(clearInterval(this.interval),this.interval=null)}},beforeDestroy(){this.clearInterval()}},bs=vs,xs=(s("5c37"),Object(l["a"])(bs,es,ss,!1,null,null,null)),ws=xs.exports,Ss={name:"SilentboxSingle",mixins:[Ze],props:{mid:{type:String,required:!0},src:{type:String,required:!0},autoplay:{type:Boolean,default(){return!1}},description:String,thumbnailWidth:{type:String,default:"200px"},thumbnailHeight:{type:String,default:"150px"},hideControls:{type:Boolean,default(){return!1}}},data(){return{overlayVisibility:!1,embedUrl:void 0,items:{total:0,position:0}}},methods:{closeSilentBoxOverlay(){this.overlayVisibility=!1},openSilentBoxOverlay(){null!==this.src&&(this.embedUrl=this.src),this.overlayVisibility=!0}},components:{SilentboxOverlay:ws,SilentboxItem:ts},mounted(){this.$on("closeSilentboxOverlay",()=>{this.overlayVisibility=!1}),window.addEventListener("keyup",t=>{27==t.which&&(this.overlayVisibility=!1)})}},_s=Ss,$s=(s("5d06"),Object(l["a"])(_s,Je,Xe,!1,null,null,null)),Ps=$s.exports,Ts=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{attrs:{id:"silentbox-group"}},[t._t("default"),s("silentbox-overlay")],2)},ks=[],Cs={name:"SilentboxGroup",data(){return{overlayVisibility:!1,mid:"",embedUrl:"",items:{total:0,position:0,list:[]},autoplay:!1,description:""}},watch:{"items.list":function(t,e){this.updateTotal(t)}},methods:{updateTotal(t){this.items.total=this.items.list.length},nextItem(){this.items.position!==this.items.total-1?this.items.position++:this.items.position=0,this.mid=this.items.list[this.items.position].mid,this.embedUrl=this.items.list[this.items.position].src,this.autoplay=void 0!==this.items.list[this.items.position].autoplay&&this.items.list[this.items.position].autoplay,this.description=void 0!==this.items.list[this.items.position].desc&&this.items.list[this.items.position].desc},prevItem(){0!==this.items.position?this.items.position--:this.items.position=this.items.total-1,this.mid=this.items.list[this.items.position].mid,this.embedUrl=this.items.list[this.items.position].src,this.autoplay=void 0!==this.items.list[this.items.position].autoplay&&this.items.list[this.items.position],this.description=void 0!==this.items.list[this.items.position].desc&&this.items.list[this.items.position].desc},setOpened(t){this.embedUrl=t.url,this.items.position=t.position,this.overlayVisibility=!0,this.autoplay=t.autoplay,this.description=t.description}},components:{"silentbox-overlay":ws},mounted(){this.$on("closeSilentboxOverlay",()=>{this.overlayVisibility=!1}),this.$on("openSilentboxOverlay",t=>{this.setOpened(t)}),this.updateTotal(this.items),window.addEventListener("keyup",t=>{27===t.which&&(this.overlayVisibility=!1),39===t.which&&t.shiftKey&&this.nextItem(),37===t.which&&t.shiftKey&&this.prevItem()})}},Os=Cs,Vs=Object(l["a"])(Os,Ts,ks,!1,null,null,null),js=Vs.exports;const Ms={install:function(t,e){t.mixin({components:{"silentbox-single":Ps,"silentbox-group":js,"silentbox-item":ts}})}};var Ws=Ms;i["a"].use(Ws),i["a"].config.productionTip=!1,new i["a"]({router:ee,store:le,vuetify:Ge,render:t=>t(m)}).$mount("#app"),window.navigator&&navigator.serviceWorker&&navigator.serviceWorker.getRegistrations().then((function(t){for(let e of t)e.unregister()}))},"584b":function(t,e,s){},"5c37":function(t,e,s){"use strict";var i=s("9075"),o=s.n(i);o.a},"5d06":function(t,e,s){"use strict";var i=s("681b"),o=s.n(i);o.a},"681b":function(t,e,s){},"6f0c":function(t,e,s){"use strict";var i=s("8feb"),o=s.n(i);o.a},7875:function(t,e,s){"use strict";var i=s("aeba"),o=s.n(i);o.a},"7b09":function(t,e,s){"use strict";var i=s("bf93"),o=s.n(i);o.a},"8feb":function(t,e,s){},9075:function(t,e,s){},"9ede":function(t,e,s){},a48f:function(t,e,s){"use strict";var i=s("281b"),o=s.n(i);o.a},aeba:function(t,e,s){},b745:function(t,e,s){"use strict";var i=s("2fb4"),o=s.n(i);o.a},b79d:function(t,e,s){},bf93:function(t,e,s){},c023:function(t,e,s){"use strict";var i=s("9ede"),o=s.n(i);o.a},c565:function(t,e,s){"use strict";var i=s("b79d"),o=s.n(i);o.a},e9ed:function(t,e,s){"use strict";var i=s("0878"),o=s.n(i);o.a},eafc:function(t,e,s){"use strict";var i=s("584b"),o=s.n(i);o.a}});
//# sourceMappingURL=app.6aae4ecc.js.map